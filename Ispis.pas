unit Ispis;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, StdCtrls, RpCon, RpBase, RpSystem, RpDefine, RpRave,
  RVClass, RVProj, RVCsStd;

type
  TfrmIspis = class(TForm)
    gbIspis: TGroupBox;
    rbIzvjesce: TRadioButton;
    rbSvjedodzba: TRadioButton;
    rbMatura: TRadioButton;
    gbRazred: TGroupBox;
    cbRazred2: TComboBox;
    gbPretraga: TGroupBox;
    lblMBroj: TLabel;
    lblIme: TLabel;
    lblPrezime: TLabel;
    lblRazred: TLabel;
    lblJMBG: TLabel;
    edMBroj: TEdit;
    lbRezultati: TListBox;
    edIme: TEdit;
    edPrezime: TEdit;
    cbRazred: TComboBox;
    btTrazi: TButton;
    edJMBG: TEdit;
    lbKontrola: TListBox;
    gbDodano: TGroupBox;
    lbDodano: TListBox;
    btDodaj: TButton;
    btIspisiPretraga: TButton;
    btIspisDodano: TButton;
    btIspisRazred: TButton;
    lblIzvjesce: TLabel;
    lblSvjedodzba: TLabel;
    lblMatura: TLabel;
    lblRazred2: TLabel;
    lbKontrola2: TListBox;
    btPregledaj: TButton;
    btOdustani: TButton;
    btIzbaci: TButton;
    procedure btTraziClick(Sender: TObject);
    procedure btIspisiPretragaClick(Sender: TObject);
    procedure btDodajClick(Sender: TObject);
    procedure btIspisDodanoClick(Sender: TObject);
    procedure btPregledajClick(Sender: TObject);
    procedure FormActivate(Sender: TObject);
    procedure btOdustaniClick(Sender: TObject);
    procedure btIzbaciClick(Sender: TObject);
    procedure btIspisRazredClick(Sender: TObject);
    procedure rbIzvjesceClick(Sender: TObject);
    procedure rbSvjedodzbaClick(Sender: TObject);
    procedure rbMaturaClick(Sender: TObject);
    procedure lbRezultatiClick(Sender: TObject);
    procedure lbDodanoClick(Sender: TObject);
    procedure cbRazred2Change(Sender: TObject);


  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  frmIspis: TfrmIspis;
  fin,kont,br:integer;
  naziv1,naziv2,poc,trazeni,trenutni,nnesto,odaberi,khm1,khm2,helou,umetanje,osl:string;
  nnesto1,nnesto2,nom,jmbg,spol,roditelji,rodjen,datumrodjenja,mjestorodjenja:string;
  drzavljanstvo,narodnost,hrv,eng,njem,lat,grc,lik,glz,psi,log,fil,soc,pov,zem,mat,fiz:string;
  kem,bio,inf,pig,tzk,dodatni1,dodatni2,dodatni3,dod1,dod2,dod3,izborni1,izborni2,izb1,izb2:string;
  fakultativni1,fakultativni2,fak1,fak2,ucenik,uspjeh,zavrsio,izostanci,datum,sss:string;
  ocjene:array[1..5] of string;
  nesto:variant;
  upisan,ned,ispisovi:boolean;
  stra:TRavePage;
  komp:TRaveText;
  olam1,olam2,olam3,olam4,olam5,olaz1,olaz2,olaz3,olaz4,olaz5,ca1,ca2,ca3,k1,k2,k3,datt,godd,god,
  datupisa,datod,datdo,bmat,isprava:string;
  am,ah,a1,a2:integer;
implementation

uses Glavna, Prijelaz;

{$R *.dfm}

procedure TfrmIspis.btTraziClick(Sender: TObject);

begin
odaberi:='select * from ucenici where ';
lbRezultati.clear;
lbKontrola.Clear;
if edMBroj.text<>'' then odaberi:=odaberi+'and MBroj='+chr(39)+edMBroj.text+chr(39);
if edIme.text<>'' then odaberi:=odaberi+'and Ime='+chr(39)+edIme.text+chr(39);
if edPrezime.text<>'' then odaberi:=odaberi+'and Prezime='+chr(39)+edPrezime.text+chr(39);
if edJMBG.text<>'' then odaberi:=odaberi+'and JMBG='+chr(39)+edJMBG.text+chr(39);
if cbRazred.text<>'' then odaberi:=odaberi+'and Razred='+chr(39)+cbRazred.text+chr(39);
if length(odaberi)<32 then delete(odaberi,22,7) else delete(odaberi,29,4);
frmglavna.podaci.Close;
frmglavna.podaci.CommandText:=odaberi;
frmglavna.podaci.ExecuteOptions;
frmglavna.podaci.Open;
while not (frmglavna.podaci.Recordset.eof) do begin
  nesto:=frmglavna.podaci.Recordset.fields.item['Prezime'].value;
  khm1:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Ime'].value;
  khm2:=nesto;
  naziv1:=khm1+' '+khm2;
  nesto:=frmglavna.podaci.Recordset.fields.item['ID'].value;
  khm1:=nesto;
  naziv2:=naziv1+'*'+khm1;
  lbRezultati.Items.Add(naziv1);
  lbKontrola.Items.add(naziv2);
  frmglavna.podaci.Recordset.MoveNext;
end;
if frmglavna.podaci.Recordset.RecordCount=0 then application.MessageBox('Nema rezultata koji zadovoljavaju Vaš upit.', 'Registar - pretraga uèenika', mb_OK);
if frmglavna.podaci.Recordset.RecordCount=0 then btdodaj.Enabled:=false;
btdodaj.Enabled:=false;
btispisipretraga.Enabled:=false;
btpregledaj.Enabled:=false;
end;

procedure TfrmIspis.btIspisiPretragaClick(Sender: TObject);
var v1,v2,i,c,vk,uk,brojac:integer;
    pr:real;
    vx,neopr,upm,upz,postm,postz,ucdod,zavz,ucca,ola,sin,kci,kontk,mj,jez1,jez2:string;
    datrod,godrod,dat,datup,godup,god1,god2,km,nije,mbroj,vrsta,klasa,vladanje,urbroj,skola,adresa,aadresa,mjesto,kojiput,razred:string;
    kgod1,kgod2,vkm,raz:integer;
begin
uk:=0; brojac:=0;
if rbmatura.Checked=true then begin
  frmglavna.podaci.close;
  frmglavna.podaci.CommandText:='select * from Postavke';
  frmglavna.podaci.ExecuteOptions;
  frmglavna.podaci.Open;
  nesto:=frmglavna.podaci.Recordset.fields.item['Skola'].value; skola:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Adresa'].value; adresa:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Mjesto'].value; mjesto:=nesto;
  aadresa:=adresa+', '+mjesto;
  poc:=lbKontrola.Items.Strings[lbRezultati.ItemIndex];
  trazeni:=copy(poc,pos('*',poc)+1,length(poc)-pos('*',poc));
  frmglavna.podaci.Close;
  frmglavna.rejv.ProjectFile:='matura1.rav';
  frmglavna.rejv2.ProjectFile:='matura2.rav';

  frmglavna.podaci.CommandText:='select * from Ucenici where ID='+trazeni;
  frmglavna.podaci.ExecuteOptions;
  frmglavna.podaci.Open;
  frmglavna.podaci2.Close;
  frmglavna.podaci2.CommandText:='select * from Matura where ID='+trazeni;
  frmglavna.podaci2.ExecuteOptions;
  frmglavna.podaci2.Open;
if frmglavna.podaci2.RecordCount>0 then begin
  frmglavna.rejv.Open;
  frmglavna.rejv2.Open;

  nesto:=frmglavna.podaci.Recordset.fields.item['Ime'].value; nnesto1:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Prezime'].value; nnesto2:=nesto;
  nom:=nnesto1+' '+nnesto2;
  nesto:=frmglavna.podaci.Recordset.fields.item['JMBG'].value; nnesto:=nesto;
  jmbg:=nnesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Spol'].value; nnesto:=nesto;
  if nnesto='M' then begin
    kci:='---'; sin:=''; rodjen:='-';
    olam1:='';olam2:='';olam3:='';olam4:='';olam5:='';
    olaz1:='-';olaz2:='-';olaz3:='-';olaz4:='-';olaz5:='-';
    ca1:='--'; ca2:='--'; ca3:='--';
    k1:='';k2:='';k3:='';
  end else begin
    kci:=''; sin:='---'; rodjen:='';
    olam1:='-';olam2:='-';olam3:='-';olam4:='-';olam5:='-';
    olaz1:='';olaz2:='';olaz3:='';olaz4:='';olaz5:='';
    ca1:=''; ca2:=''; ca3:='';
    k1:='-';k2:='-';k3:='-';
  end;
  nesto:=frmglavna.podaci.Recordset.fields.item['DatRod'].value; datumrodjenja:=nesto;
  kontk:=copy(datumrodjenja,4,2);
  if kontk='01' then mj:='sijeènja';
  if kontk='02' then mj:='veljaèe';
  if kontk='03' then mj:='ožujka';
  if kontk='04' then mj:='travnja';
  if kontk='05' then mj:='svibnja';
  if kontk='06' then mj:='lipnja';
  if kontk='07' then mj:='srpnja';
  if kontk='08' then mj:='kolovoza';
  if kontk='09' then mj:='rujna';
  if kontk='10' then mj:='listopada';
  if kontk='11' then mj:='studenog';
  if kontk='12' then mj:='prosinca';
  kontk:=copy(datumrodjenja,1,3);
  if kontk[1]='0' then delete(kontk,1,1);
  datrod:=kontk+' '+mj;
  godrod:=datumrodjenja[9]+datumrodjenja[10];

  nesto:=frmglavna.podaci.Recordset.fields.item['DatRod'].value; datumrodjenja:=nesto;
  kontk:=copy(datumrodjenja,4,2);
  if kontk='01' then mj:='sijeènja';
  if kontk='02' then mj:='veljaèe';
  if kontk='03' then mj:='ožujka';
  if kontk='04' then mj:='travnja';
  if kontk='05' then mj:='svibnja';
  if kontk='06' then mj:='lipnja';
  if kontk='07' then mj:='srpnja';
  if kontk='08' then mj:='kolovoza';
  if kontk='09' then mj:='rujna';
  if kontk='10' then mj:='listopada';
  if kontk='11' then mj:='studenog';
  if kontk='12' then mj:='prosinca';
  kontk:=copy(datumrodjenja,1,3);
  if kontk[1]='0' then delete(kontk,1,1);
  datt:=kontk+' '+mj;
  godd:=datumrodjenja[9]+datumrodjenja[10];


  nesto:=frmglavna.podaci.Recordset.fields.item['Datupisa'].value; dat:=nesto;
  kontk:=copy(dat,4,2);
  if kontk='01' then mj:='sijeènja';
  if kontk='02' then mj:='veljaèe';
  if kontk='03' then mj:='ožujka';
  if kontk='04' then mj:='travnja';
  if kontk='05' then mj:='svibnja';
  if kontk='06' then mj:='lipnja';
  if kontk='07' then mj:='srpnja';
  if kontk='08' then mj:='kolovoza';
  if kontk='09' then mj:='rujna';
  if kontk='10' then mj:='listopada';
  if kontk='11' then mj:='studenog';
  if kontk='12' then mj:='prosinca';
  kontk:=copy(dat,1,3);
  if kontk[1]='0' then delete(kontk,1,1);
  god:=dat[7]+dat[8]+dat[9]+dat[10]+'.';
  datupisa:=kontk+' '+mj+' '+god;

  nesto:=frmglavna.podaci2.Recordset.fields.item['Od'].value; dat:=nesto;
  kontk:=copy(dat,4,2);
  if kontk='01' then mj:='sijeènja';
  if kontk='02' then mj:='veljaèe';
  if kontk='03' then mj:='ožujka';
  if kontk='04' then mj:='travnja';
  if kontk='05' then mj:='svibnja';
  if kontk='06' then mj:='lipnja';
  if kontk='07' then mj:='srpnja';
  if kontk='08' then mj:='kolovoza';
  if kontk='09' then mj:='rujna';
  if kontk='10' then mj:='listopada';
  if kontk='11' then mj:='studenog';
  if kontk='12' then mj:='prosinca';
  kontk:=copy(dat,1,3);
  if kontk[1]='0' then delete(kontk,1,1);
  god:=dat[7]+dat[8]+dat[9]+dat[10]+'.';
  datod:=kontk+' '+mj+' '+god;

  nesto:=frmglavna.podaci2.Recordset.fields.item['Do'].value; dat:=nesto;
  kontk:=copy(dat,4,2);
  if kontk='01' then mj:='sijeènja';
  if kontk='02' then mj:='veljaèe';
  if kontk='03' then mj:='ožujka';
  if kontk='04' then mj:='travnja';
  if kontk='05' then mj:='svibnja';
  if kontk='06' then mj:='lipnja';
  if kontk='07' then mj:='srpnja';
  if kontk='08' then mj:='kolovoza';
  if kontk='09' then mj:='rujna';
  if kontk='10' then mj:='listopada';
  if kontk='11' then mj:='studenog';
  if kontk='12' then mj:='prosinca';
  kontk:=copy(dat,1,3);
  if kontk[1]='0' then delete(kontk,1,1);
  god:=dat[7]+dat[8]+dat[9]+dat[10]+'.';
  datdo:=kontk+' '+mj+' '+god;


  nesto:=frmglavna.podaci.Recordset.fields.item['Datupisa'].value; dat:=nesto;
  km:=dat[7]+dat[8]+dat[9]+dat[10];
  val(km,vkm,c);
  nesto:=frmglavna.podaci.Recordset.fields.item['Razred'].value; dat:=nesto;
  val(dat[1],raz,c);
  kgod1:=(raz-1)+vkm;
  kgod2:=kgod1+1;
  str(kgod1,god1);
  str(kgod2,god2);
  nesto:=frmglavna.podaci.Recordset.fields.item['MjRod'].value; nnesto1:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['DrzRod'].value; nnesto2:=nesto;
  mjestorodjenja:=nnesto1+', '+nnesto2;
  nesto:=frmglavna.podaci.Recordset.fields.item['Drz'].value; drzavljanstvo:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Nar'].value; narodnost:=nesto;
  ocjene[2]:='dovoljan (2)';
  ocjene[3]:='dobar (3)';
  ocjene[4]:='vrlo dobar (4)';
  ocjene[5]:='odlièan (5)';
  nesto:=frmglavna.podaci2.Recordset.fields.item['mat'].value; bmat:=nesto;
  val(bmat,am,c); if am<>0 then mat:=ocjene[am] else mat:='-';
  nesto:=frmglavna.podaci2.Recordset.fields.item['hrv'].value; bmat:=nesto;
  val(bmat,ah,c); if ah<>0 then hrv:=ocjene[ah] else hrv:='-';
  nesto:=frmglavna.podaci2.Recordset.fields.item['izb1'].value; bmat:=nesto;
  val(bmat,a1,c); if a1<>0 then izb1:=ocjene[a1] else izb1:='-';
  nesto:=frmglavna.podaci2.Recordset.fields.item['izb2'].value; bmat:=nesto;
  val(bmat,a2,c); if a2<>0 then izb2:=ocjene[a2] else izb2:='-';
  nesto:=frmglavna.podaci2.Recordset.fields.item['izborni1'].value; bmat:=nesto;
  if bmat<>'' then izborni1:=bmat else izborni1:='-';
  nesto:=frmglavna.podaci2.Recordset.fields.item['izborni2'].value; bmat:=nesto;
  if bmat<>'' then izborni2:=bmat else izborni2:='-';
  nesto:=frmglavna.podaci2.Recordset.fields.item['osl'].value; bmat:=nesto;
  if bmat='DA' then uspjeh:=mat else begin
    pr:=(ah+am+a1+a2)/4;
    if pr>=4.5 then uspjeh:='odlièan (5)';
    if (pr<4.5) and (pr>=3.5) then uspjeh:='vrlo dobar (4)';
    if (pr<3.5) and (pr>=2.5) then uspjeh:='dobar (3)';
    if (pr<2.5) and (pr>=1.5) then uspjeh:='dovoljan (2)';
  end;
  nesto:=frmglavna.podaci.Recordset.fields.item['Imeoca'].value; nnesto1:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Imemajke'].value; nnesto2:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Isprava'].value; isprava:=nesto;
  roditelji:=nnesto1+' i '+nnesto2;
  nesto:=frmglavna.podaci.Recordset.fields.item['MBroj'].value; mbroj:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Vrsta'].value; vrsta:=nesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Klasa'].value; klasa:=nesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['UrBroj'].value; urbroj:=nesto;
  frmglavna.podaci.close;
  frmglavna.podaci2.close;
  with frmglavna.rejv.ProjMan do begin
    stra:=findravecomponent('Report1.Page1',nil) as Travepage;
    komp:=FindRaveComponent('skola',stra) as TRaveText; komp.Text:=skola;
    komp:=FindRaveComponent('adresa',stra) as TRaveText; komp.Text:=aadresa;
    komp:=FindRaveComponent('klasa',stra) as TRaveText; komp.Text:=klasa;
    komp:=FindRaveComponent('urbroj',stra) as TRaveText; komp.Text:=urbroj;
    komp:=FindRaveComponent('mbroj',stra) as TRaveText; komp.Text:=mbroj;
  end;
  with frmglavna.rejv2.ProjMan do begin
    stra:=findravecomponent('Report1.Page1',nil) as Travepage;
    komp:=FindRaveComponent('ime',stra) as TRaveText; komp.Text:=skola;
    
    komp:=FindRaveComponent('olam1',stra) as TRaveText; komp.Text:=olam1;
    komp:=FindRaveComponent('olaz1',stra) as TRaveText; komp.Text:=olaz1;
    komp:=FindRaveComponent('olam2',stra) as TRaveText; komp.Text:=olam2;
    komp:=FindRaveComponent('olaz2',stra) as TRaveText; komp.Text:=olaz2;
    komp:=FindRaveComponent('olam3',stra) as TRaveText; komp.Text:=olam3;
    komp:=FindRaveComponent('olaz3',stra) as TRaveText; komp.Text:=olaz3;
    komp:=FindRaveComponent('olam4',stra) as TRaveText; komp.Text:=olam4;
    komp:=FindRaveComponent('olaz4',stra) as TRaveText; komp.Text:=olaz4;
    komp:=FindRaveComponent('olam5',stra) as TRaveText; komp.Text:=olam5;
    komp:=FindRaveComponent('olaz5',stra) as TRaveText; komp.Text:=olaz5;
    komp:=FindRaveComponent('ca1',stra) as TRaveText; komp.Text:=ca1;
    komp:=FindRaveComponent('ca2',stra) as TRaveText; komp.Text:=ca2;
    komp:=FindRaveComponent('ca3',stra) as TRaveText; komp.Text:=ca3;
    komp:=FindRaveComponent('k1',stra) as TRaveText; komp.Text:=k1;
    komp:=FindRaveComponent('k2',stra) as TRaveText; komp.Text:=k2;
    komp:=FindRaveComponent('k3',stra) as TRaveText; komp.Text:=k3;
    komp:=FindRaveComponent('kci',stra) as TRaveText; komp.Text:=kci;
    komp:=FindRaveComponent('sin',stra) as TRaveText; komp.Text:=sin;
    komp:=FindRaveComponent('rodjen',stra) as TRaveText; komp.Text:=rodjen;

    komp:=FindRaveComponent('roditelji',stra) as TRaveText; komp.Text:=roditelji;
    komp:=FindRaveComponent('datrod',stra) as TRaveText; komp.Text:=datrod;
    komp:=FindRaveComponent('godrod',stra) as TRaveText; komp.Text:=godrod;
    komp:=FindRaveComponent('mjdrz',stra) as TRaveText; komp.Text:=mjestorodjenja;
    komp:=FindRaveComponent('drz',stra) as TRaveText; komp.Text:=drzavljanstvo;
    komp:=FindRaveComponent('nar',stra) as TRaveText; komp.Text:=narodnost;
    komp:=FindRaveComponent('isprava',stra) as TRaveText; komp.Text:=isprava;
    komp:=FindRaveComponent('datupisa',stra) as TRaveText; komp.Text:=datupisa;
    komp:=FindRaveComponent('vrsta',stra) as TRaveText; komp.Text:=vrsta;
    komp:=FindRaveComponent('datmat',stra) as TRaveText; komp.Text:=datdo;
    komp:=FindRaveComponent('od',stra) as TRaveText; komp.Text:=datod;
    komp:=FindRaveComponent('do',stra) as TRaveText; komp.Text:=datdo;
    komp:=FindRaveComponent('mat',stra) as TRaveText; komp.Text:=mat;
    komp:=FindRaveComponent('hrv',stra) as TRaveText; komp.Text:=hrv;
    komp:=FindRaveComponent('izb1',stra) as TRaveText; komp.Text:=izb1;
    komp:=FindRaveComponent('izb2',stra) as TRaveText; komp.Text:=izb2;
    komp:=FindRaveComponent('izborni1',stra) as TRaveText; komp.Text:=izborni1;
    komp:=FindRaveComponent('izborni2',stra) as TRaveText; komp.Text:=izborni2;
    komp:=FindRaveComponent('uspjeh',stra) as TRaveText; komp.Text:=uspjeh;
    komp:=FindRaveComponent('mjesto',stra) as TRaveText; komp.Text:=mjesto;
    komp:=FindRaveComponent('dat',stra) as TRaveText; komp.Text:=datt;
    komp:=FindRaveComponent('god',stra) as TRaveText; komp.Text:=godd;
  end;
  frmglavna.sistem.DoNativeOutput:=false;
  frmglavna.sistem.DefaultDest:=rdprinter;
  frmglavna.sistem.SystemSetups:=frmglavna.sistem.SystemSetups - [ssAllowSetup];
  frmglavna.rejv.ExecuteReport('Report1');
  frmglavna.rejv.Close;
  application.MessageBox('Molim, okrenite stranu...', 'Registar - ispis maturalne svjedodžbe', mb_OK);
  frmglavna.rejv2.ExecuteReport('Report1');
  frmglavna.rejv2.Close;
end else application.MessageBox('Selektirani uèenik nema podatke o maturi.', 'Registar - ispis maturalne svjedodžbe', mb_OK);
end;

if rbizvjesce.Checked=true then begin
  frmglavna.podaci.close;
  frmglavna.podaci.CommandText:='select * from Postavke';
  frmglavna.podaci.ExecuteOptions;
  frmglavna.podaci.Open;
  nesto:=frmglavna.podaci.Recordset.fields.item['Skola'].value; skola:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Adresa'].value; adresa:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Mjesto'].value; mjesto:=nesto;
  aadresa:=adresa+', '+mjesto;
  frmglavna.podaci.Close;

  frmglavna.rejv.ProjectFile:='izvjesce.rav';
  poc:=lbKontrola.Items.Strings[lbRezultati.ItemIndex];
  trazeni:=copy(poc,pos('*',poc)+1,length(poc)-pos('*',poc));
  frmglavna.podaci.Close;
  frmglavna.podaci.CommandText:='select * from Ucenici where ID='+trazeni;
  frmglavna.podaci.ExecuteOptions;
  frmglavna.podaci.Open;
  frmglavna.podaci2.Close;
  frmglavna.podaci2.CommandText:='select * from Polugodiste where ID='+trazeni;
  frmglavna.podaci2.ExecuteOptions;
  frmglavna.podaci2.Open;
  frmglavna.rejv.Open;
  nesto:=frmglavna.podaci.Recordset.fields.item['Ime'].value; nnesto1:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Prezime'].value; nnesto2:=nesto;
  nom:=nnesto1+' '+nnesto2;
  nesto:=frmglavna.podaci.Recordset.fields.item['JMBG'].value; nnesto:=nesto;
  for i:=1 to length(nesto) do jmbg:=jmbg+nnesto[i]+' ';
  delete(jmbg,length(jmbg),1);
  nesto:=frmglavna.podaci.Recordset.fields.item['Spol'].value; nnesto:=nesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Opravdani'].value; nnesto1:=nesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Neopravdani'].value; nnesto2:=nesto;
  val(nnesto1,v1,c); val(nnesto2,v2,c);
  str(v1+v2,vx);
  if nnesto='M' then begin
    spol:='sin'; rodjen:='roðen'; ucenik:='Uèenik je s';
    zavrsio:='uspjehom završio prvo polugodište.';
    izostanci:='Uèenik je izostao '+vx+' sati (od toga neopravdano '+nnesto2+' sati).';
  end else begin
    spol:='kæi'; rodjen:='roðena'; ucenik:='Uèenica je s';
    zavrsio:='uspjehom završila prvo polugodište.';
    izostanci:='Uèenica je izostala '+vx+' sati (od toga neopravdano '+nnesto2+' sati).';
  end;
  nesto:=frmglavna.podaci.Recordset.fields.item['DatRod'].value; datumrodjenja:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['MjRod'].value; nnesto1:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['DrzRod'].value; nnesto2:=nesto;
  mjestorodjenja:=nnesto1+', '+nnesto2;
  nesto:=frmglavna.podaci.Recordset.fields.item['Drz'].value; drzavljanstvo:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Nar'].value; narodnost:=nesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Datum'].value; datum:=nesto;
  ocjene[1]:='nedovoljan (1)';
  ocjene[2]:='dovoljan (2)';
  ocjene[3]:='dobar (3)';
  ocjene[4]:='vrlo dobar (4)';
  ocjene[5]:='odlièan (5)';
  ned:=false;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Hrv'].value; nnesto:=nesto; if nnesto='' then hrv:='-' else begin val(nnesto,vk,c); hrv:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['lat'].value; nnesto:=nesto; if nnesto='' then lat:='-' else begin val(nnesto,vk,c); lat:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['grc'].value; nnesto:=nesto; if nnesto='' then grc:='-' else begin val(nnesto,vk,c); grc:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['glz'].value; nnesto:=nesto; if nnesto='' then glz:='-' else begin val(nnesto,vk,c); glz:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['lik'].value; nnesto:=nesto; if nnesto='' then lik:='-' else begin val(nnesto,vk,c); lik:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['psi'].value; nnesto:=nesto; if nnesto='' then psi:='-' else begin val(nnesto,vk,c); psi:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['log'].value; nnesto:=nesto; if nnesto='' then log:='-' else begin val(nnesto,vk,c); log:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['fil'].value; nnesto:=nesto; if nnesto='' then fil:='-' else begin val(nnesto,vk,c); fil:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['soc'].value; nnesto:=nesto; if nnesto='' then soc:='-' else begin val(nnesto,vk,c); soc:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['pov'].value; nnesto:=nesto; if nnesto='' then pov:='-' else begin val(nnesto,vk,c); pov:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['zem'].value; nnesto:=nesto; if nnesto='' then zem:='-' else begin val(nnesto,vk,c); zem:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['mat'].value; nnesto:=nesto; if nnesto='' then mat:='-' else begin val(nnesto,vk,c); mat:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['fiz'].value; nnesto:=nesto; if nnesto='' then fiz:='-' else begin val(nnesto,vk,c); fiz:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['kem'].value; nnesto:=nesto; if nnesto='' then kem:='-' else begin val(nnesto,vk,c); kem:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['bio'].value; nnesto:=nesto; if nnesto='' then bio:='-' else begin val(nnesto,vk,c); bio:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['inf'].value; nnesto:=nesto; if nnesto='' then inf:='-' else begin val(nnesto,vk,c); inf:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['pig'].value; nnesto:=nesto; if nnesto='' then pig:='-' else begin val(nnesto,vk,c); pig:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['tzk'].value; nnesto:=nesto; if nnesto='' then tzk:='-' else begin val(nnesto,vk,c); tzk:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['dod1'].value; nnesto:=nesto; if nnesto='' then dod1:='-' else begin val(nnesto,vk,c); dod1:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['dod2'].value; nnesto:=nesto; if nnesto='' then dod2:='-' else begin val(nnesto,vk,c); dod2:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['dod3'].value; nnesto:=nesto; if nnesto='' then dod3:='-' else begin val(nnesto,vk,c); dod3:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['izb1'].value; nnesto:=nesto; if nnesto='' then izb1:='-' else begin val(nnesto,vk,c); izb1:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['izb2'].value; nnesto:=nesto; if nnesto='' then izb2:='-' else begin val(nnesto,vk,c); izb2:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['fak1'].value; nnesto:=nesto; if nnesto='' then fak1:='-' else begin val(nnesto,vk,c); fak1:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['fak2'].value; nnesto:=nesto; if nnesto='' then fak2:='-' else begin val(nnesto,vk,c); fak2:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['PrviJezik'].value; nnesto:=nesto;
  if nnesto<>'' then begin
    jez1:=nnesto;
    nesto:=frmglavna.podaci2.Recordset.fields.item['1jez'].value; nnesto1:=nesto;
    val(nnesto1,vk,c); eng:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true;
  end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['DrugiJezik'].value; nnesto:=nesto;
  if nnesto<>'' then begin
    jez2:=nnesto;
    nesto:=frmglavna.podaci2.Recordset.fields.item['2jez'].value; nnesto1:=nesto;
    val(nnesto1,vk,c); njem:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true;
  end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Dodatni1'].value; nnesto:=nesto; if nnesto='' then nnesto:='-'; dodatni1:=nnesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Dodatni2'].value; nnesto:=nesto; if nnesto='' then nnesto:='-'; dodatni2:=nnesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Dodatni3'].value; nnesto:=nesto; if nnesto='' then nnesto:='-'; dodatni3:=nnesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Izborni1'].value; nnesto:=nesto; if nnesto='' then nnesto:='-'; izborni1:=nnesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Izborni2'].value; nnesto:=nesto; if nnesto='' then nnesto:='-'; izborni2:=nnesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Fakultativni1'].value; nnesto:=nesto; if nnesto='' then nnesto:='-'; fakultativni1:=nnesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Fakultativni2'].value; nnesto:=nesto; if nnesto='' then nnesto:='-'; fakultativni2:=nnesto;
  pr:=uk/brojac;
  if pr>=4.5 then uspjeh:='odliènim';
  if (pr<4.5) and (pr>=3.5) then uspjeh:='vrlo dobrim';
  if (pr<3.5) and (pr>=2.5) then uspjeh:='dobrim';
  if (pr<2.5) and (pr>=1.5) then uspjeh:='dovoljnim';
  if ned=true then uspjeh:='nedovoljnim';
  nesto:=frmglavna.podaci.Recordset.fields.item['Imeoca'].value; nnesto1:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Imemajke'].value; nnesto2:=nesto;
  roditelji:=nnesto1+' i '+nnesto2;

  with frmglavna.rejv.ProjMan do begin
    stra:=findravecomponent('Izvjesce.Stranica',nil) as Travepage;
    komp:=FindRaveComponent('Skola',stra) as TRaveText; komp.Text:=skola;
    komp:=FindRaveComponent('Adresa',stra) as TRaveText; komp.Text:=aadresa;
    komp:=FindRaveComponent('Ime',stra) as TRaveText; komp.Text:=nom;
    komp:=FindRaveComponent('JMBG',stra) as TRaveText; komp.Text:=jmbg;
    komp:=FindRaveComponent('Spol',stra) as TRaveText; komp.Text:=spol;
    komp:=FindRaveComponent('Roditelji',stra) as TRaveText; komp.Text:=roditelji;
    komp:=FindRaveComponent('Rodjen',stra) as TRaveText; komp.Text:=rodjen;
    komp:=FindRaveComponent('DatumRodjenja',stra) as TRaveText; komp.Text:=datumrodjenja;
    komp:=FindRaveComponent('Mjestorodjenja',stra) as TRaveText; komp.Text:=mjestorodjenja;
    komp:=FindRaveComponent('Drzavljanstvo',stra) as TRaveText; komp.Text:=drzavljanstvo;
    komp:=FindRaveComponent('Narodnost',stra) as TRaveText; komp.Text:=narodnost;
    komp:=FindRaveComponent('hrv',stra) as TRaveText; komp.Text:=hrv;
    komp:=FindRaveComponent('eng',stra) as TRaveText; komp.Text:=eng;
    komp:=FindRaveComponent('njem',stra) as TRaveText; komp.Text:=njem;
    komp:=FindRaveComponent('lat',stra) as TRaveText; komp.Text:=lat;
    komp:=FindRaveComponent('grc',stra) as TRaveText; komp.Text:=grc;
    komp:=FindRaveComponent('glz',stra) as TRaveText; komp.Text:=glz;
    komp:=FindRaveComponent('lik',stra) as TRaveText; komp.Text:=lik;
    komp:=FindRaveComponent('psi',stra) as TRaveText; komp.Text:=psi;
    komp:=FindRaveComponent('log',stra) as TRaveText; komp.Text:=log;
    komp:=FindRaveComponent('fil',stra) as TRaveText; komp.Text:=fil;
    komp:=FindRaveComponent('soc',stra) as TRaveText; komp.Text:=soc;
    komp:=FindRaveComponent('pov',stra) as TRaveText; komp.Text:=pov;
    komp:=FindRaveComponent('zem',stra) as TRaveText; komp.Text:=zem;
    komp:=FindRaveComponent('mat',stra) as TRaveText; komp.Text:=mat;
    komp:=FindRaveComponent('fiz',stra) as TRaveText; komp.Text:=fiz;
    komp:=FindRaveComponent('kem',stra) as TRaveText; komp.Text:=kem;
    komp:=FindRaveComponent('bio',stra) as TRaveText; komp.Text:=bio;
    komp:=FindRaveComponent('inf',stra) as TRaveText; komp.Text:=inf;
    komp:=FindRaveComponent('pig',stra) as TRaveText; komp.Text:=pig;
    komp:=FindRaveComponent('tzk',stra) as TRaveText; komp.Text:=tzk;
    komp:=FindRaveComponent('dodatni1',stra) as TRaveText; komp.Text:=dodatni1;
    komp:=FindRaveComponent('dodatni2',stra) as TRaveText; komp.Text:=dodatni2;
    komp:=FindRaveComponent('dodatni3',stra) as TRaveText; komp.Text:=dodatni3;
    komp:=FindRaveComponent('dod1',stra) as TRaveText; komp.Text:=dod1;
    komp:=FindRaveComponent('dod2',stra) as TRaveText; komp.Text:=dod2;
    komp:=FindRaveComponent('dod3',stra) as TRaveText; komp.Text:=dod3;
    komp:=FindRaveComponent('izborni1',stra) as TRaveText; komp.Text:=izborni1;
    komp:=FindRaveComponent('izborni2',stra) as TRaveText; komp.Text:=izborni2;
    komp:=FindRaveComponent('izb1',stra) as TRaveText; komp.Text:=izb1;
    komp:=FindRaveComponent('izb2',stra) as TRaveText; komp.Text:=izb2;
    komp:=FindRaveComponent('fakultativni1',stra) as TRaveText; komp.Text:=fakultativni1;
    komp:=FindRaveComponent('fakultativni2',stra) as TRaveText; komp.Text:=fakultativni2;
    komp:=FindRaveComponent('fak1',stra) as TRaveText; komp.Text:=fak1;
    komp:=FindRaveComponent('fak2',stra) as TRaveText; komp.Text:=fak2;
    komp:=FindRaveComponent('ucenik',stra) as TRaveText; komp.Text:=ucenik;
    komp:=FindRaveComponent('uspjeh',stra) as TRaveText; komp.Text:=uspjeh;
    komp:=FindRaveComponent('zavrsio',stra) as TRaveText; komp.Text:=zavrsio;
    komp:=FindRaveComponent('izostanci',stra) as TRaveText; komp.Text:=izostanci;
    komp:=FindRaveComponent('datum',stra) as TRaveText; komp.Text:=datum;
  end;
  frmglavna.sistem.DoNativeOutput:=false;
  frmglavna.sistem.DefaultDest:=rdprinter;
  frmglavna.sistem.SystemSetups:=frmglavna.sistem.SystemSetups - [ssAllowSetup];
  frmglavna.rejv.ExecuteReport('Izvjesce');
  frmglavna.rejv.Close;
end;


if rbsvjedodzba.Checked=true then begin
  frmglavna.podaci.close;
  frmglavna.podaci.CommandText:='select * from Postavke';
  frmglavna.podaci.ExecuteOptions;
  frmglavna.podaci.Open;
  nesto:=frmglavna.podaci.Recordset.fields.item['Skola'].value; skola:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Adresa'].value; adresa:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Mjesto'].value; mjesto:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['SkGod'].value; sss:=nesto;
  aadresa:=adresa+', '+mjesto;
  poc:=lbKontrola.Items.Strings[lbRezultati.ItemIndex];
  trazeni:=copy(poc,pos('*',poc)+1,length(poc)-pos('*',poc));
  frmglavna.podaci.Close;
  frmglavna.rejv.ProjectFile:='svjedodzba.rav';
  frmglavna.podaci.CommandText:='select * from Ucenici where ID='+trazeni;
  frmglavna.podaci.ExecuteOptions;
  frmglavna.podaci.Open;
  frmglavna.podaci2.Close;
  frmglavna.podaci2.CommandText:='select * from Kraj where ID='+trazeni;
  frmglavna.podaci2.ExecuteOptions;
  frmglavna.podaci2.Open;
  frmglavna.rejv.Open;
  nesto:=frmglavna.podaci.Recordset.fields.item['Ime'].value; nnesto1:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Prezime'].value; nnesto2:=nesto;
  nom:=nnesto1+' '+nnesto2;
  nesto:=frmglavna.podaci.Recordset.fields.item['JMBG'].value; nnesto:=nesto;
  jmbg:=nnesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Spol'].value; nnesto:=nesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Opravdani'].value; nnesto1:=nesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Neopravdani'].value; nnesto2:=nesto;
  val(nnesto1,v1,c); val(nnesto2,v2,c); neopr:=nnesto2;
  str(v1+v2,vx);
  if nnesto='M' then begin
    sin:='--'; kci:=''; rodjen:='';
    upm:='-'; upz:='';
    postm:='-'; postz:='';
    ucdod:='k'; zavz:='o';
    ucca:='k'; ola:='o';
  end else begin
    sin:=''; kci:='--'; rodjen:='a';
    upm:='-'; upz:='-';
    postm:=''; postz:='-';
    ucdod:='ca'; zavz:='la';
    ucca:='ca'; ola:='la';
  end;
  nesto:=frmglavna.podaci.Recordset.fields.item['DatRod'].value; datumrodjenja:=nesto;
  kontk:=copy(datumrodjenja,4,2);
  if kontk='01' then mj:='sijeènja';
  if kontk='02' then mj:='veljaèe';
  if kontk='03' then mj:='ožujka';
  if kontk='04' then mj:='travnja';
  if kontk='05' then mj:='svibnja';
  if kontk='06' then mj:='lipnja';
  if kontk='07' then mj:='srpnja';
  if kontk='08' then mj:='kolovoza';
  if kontk='09' then mj:='rujna';
  if kontk='10' then mj:='listopada';
  if kontk='11' then mj:='studenog';
  if kontk='12' then mj:='prosinca';
  kontk:=copy(datumrodjenja,1,3);
  if kontk[1]='0' then delete(kontk,1,1);
  datrod:=kontk+' '+mj;
  godrod:=datumrodjenja[9]+datumrodjenja[10];

  nesto:=frmglavna.podaci2.Recordset.fields.item['Datum'].value; dat:=nesto;
  kontk:=copy(dat,4,2);
  if kontk='01' then mj:='sijeènja';
  if kontk='02' then mj:='veljaèe';
  if kontk='03' then mj:='ožujka';
  if kontk='04' then mj:='travnja';
  if kontk='05' then mj:='svibnja';
  if kontk='06' then mj:='lipnja';
  if kontk='07' then mj:='srpnja';
  if kontk='08' then mj:='kolovoza';
  if kontk='09' then mj:='rujna';
  if kontk='10' then mj:='listopada';
  if kontk='11' then mj:='studenog';
  if kontk='12' then mj:='prosinca';
  kontk:=copy(dat,1,3);
  if kontk[1]='0' then delete(kontk,1,1);
  datup:=kontk+' '+mj;
  godup:=dat[9]+dat[10];
  nesto:=frmglavna.podaci.Recordset.fields.item['Datupisa'].value; dat:=nesto;
  km:=dat[7]+dat[8]+dat[9]+dat[10];
  val(km,vkm,c);
  nesto:=frmglavna.podaci.Recordset.fields.item['Razred'].value; dat:=nesto;
  val(dat[1],raz,c);
  kgod1:=(raz-1)+vkm;
  kgod2:=kgod1+1;
  god1:=sss[1]+sss[2]+sss[3]+sss[4]+sss[5];
  god2:=sss[7]+sss[8]+sss[9]+sss[10]+sss[11];
  nesto:=frmglavna.podaci.Recordset.fields.item['MjRod'].value; nnesto1:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['DrzRod'].value; nnesto2:=nesto;
  mjestorodjenja:=nnesto1+', '+nnesto2;
  nesto:=frmglavna.podaci.Recordset.fields.item['Drz'].value; drzavljanstvo:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Nar'].value; narodnost:=nesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Datum'].value; datum:=nesto;
  ocjene[1]:='nedovoljan (1)';
  ocjene[2]:='dovoljan (2)';
  ocjene[3]:='dobar (3)';
  ocjene[4]:='vrlo dobar (4)';
  ocjene[5]:='odlièan (5)';
  ned:=false;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Hrv'].value; nnesto:=nesto; if nnesto='' then hrv:='-' else begin val(nnesto,vk,c); hrv:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['lat'].value; nnesto:=nesto; if nnesto='' then lat:='-' else begin val(nnesto,vk,c); lat:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['grc'].value; nnesto:=nesto; if nnesto='' then grc:='-' else begin val(nnesto,vk,c); grc:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['glz'].value; nnesto:=nesto; if nnesto='' then glz:='-' else begin val(nnesto,vk,c); glz:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['lik'].value; nnesto:=nesto; if nnesto='' then lik:='-' else begin val(nnesto,vk,c); lik:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['psi'].value; nnesto:=nesto; if nnesto='' then psi:='-' else begin val(nnesto,vk,c); psi:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['log'].value; nnesto:=nesto; if nnesto='' then log:='-' else begin val(nnesto,vk,c); log:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['fil'].value; nnesto:=nesto; if nnesto='' then fil:='-' else begin val(nnesto,vk,c); fil:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['soc'].value; nnesto:=nesto; if nnesto='' then soc:='-' else begin val(nnesto,vk,c); soc:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['pov'].value; nnesto:=nesto; if nnesto='' then pov:='-' else begin val(nnesto,vk,c); pov:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['zem'].value; nnesto:=nesto; if nnesto='' then zem:='-' else begin val(nnesto,vk,c); zem:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['mat'].value; nnesto:=nesto; if nnesto='' then mat:='-' else begin val(nnesto,vk,c); mat:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['fiz'].value; nnesto:=nesto; if nnesto='' then fiz:='-' else begin val(nnesto,vk,c); fiz:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['kem'].value; nnesto:=nesto; if nnesto='' then kem:='-' else begin val(nnesto,vk,c); kem:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['bio'].value; nnesto:=nesto; if nnesto='' then bio:='-' else begin val(nnesto,vk,c); bio:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['inf'].value; nnesto:=nesto; if nnesto='' then inf:='-' else begin val(nnesto,vk,c); inf:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['pig'].value; nnesto:=nesto; if nnesto='' then pig:='-' else begin val(nnesto,vk,c); pig:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['tzk'].value; nnesto:=nesto; if nnesto='' then tzk:='-' else begin val(nnesto,vk,c); tzk:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['dod1'].value; nnesto:=nesto; if nnesto='' then dod1:='-' else begin val(nnesto,vk,c); dod1:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['dod2'].value; nnesto:=nesto; if nnesto='' then dod2:='-' else begin val(nnesto,vk,c); dod2:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['dod3'].value; nnesto:=nesto; if nnesto='' then dod3:='-' else begin val(nnesto,vk,c); dod3:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['izb1'].value; nnesto:=nesto; if nnesto='' then izb1:='-' else begin val(nnesto,vk,c); izb1:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['izb2'].value; nnesto:=nesto; if nnesto='' then izb2:='-' else begin val(nnesto,vk,c); izb2:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['fak1'].value; nnesto:=nesto; if nnesto='' then fak1:='-' else begin val(nnesto,vk,c); fak1:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['fak2'].value; nnesto:=nesto; if nnesto='' then fak2:='-' else begin val(nnesto,vk,c); fak2:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['PrviJezik'].value; nnesto:=nesto;
  if nnesto<>'' then begin
    jez1:=nnesto;
    nesto:=frmglavna.podaci2.Recordset.fields.item['1jez'].value; nnesto1:=nesto;
    val(nnesto1,vk,c); eng:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true;
  end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['DrugiJezik'].value; nnesto:=nesto;
  if nnesto<>'' then begin
    jez2:=nnesto;
    nesto:=frmglavna.podaci2.Recordset.fields.item['2jez'].value; nnesto1:=nesto;
    val(nnesto1,vk,c); njem:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true;
  end;

  nesto:=frmglavna.podaci2.Recordset.fields.item['Dodatni1'].value; nnesto:=nesto; if nnesto='' then nnesto:='-'; dodatni1:=nnesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Dodatni2'].value; nnesto:=nesto; if nnesto='' then nnesto:='-'; dodatni2:=nnesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Dodatni3'].value; nnesto:=nesto; if nnesto='' then nnesto:='-'; dodatni3:=nnesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Izborni1'].value; nnesto:=nesto; if nnesto='' then nnesto:='-'; izborni1:=nnesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Izborni2'].value; nnesto:=nesto; if nnesto='' then nnesto:='-'; izborni2:=nnesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Fakultativni1'].value; nnesto:=nesto; if nnesto='' then nnesto:='-'; fakultativni1:=nnesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Fakultativni2'].value; nnesto:=nesto; if nnesto='' then nnesto:='-'; fakultativni2:=nnesto;
  pr:=uk/brojac;
  if pr>=4.5 then uspjeh:='odliènim';
  if (pr<4.5) and (pr>=3.5) then uspjeh:='vrlo dobrim';
  if (pr<3.5) and (pr>=2.5) then uspjeh:='dobrim';
  if (pr<2.5) and (pr>=1.5) then uspjeh:='dovoljnim';
  nije:='';
  if ned=true then begin uspjeh:='prolaznim'; nije:='ni'; end;
  nesto:=frmglavna.podaci.Recordset.fields.item['Imeoca'].value; nnesto1:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Imemajke'].value; nnesto2:=nesto;
  roditelji:=nnesto1+' i '+nnesto2;
  nesto:=frmglavna.podaci.Recordset.fields.item['MBroj'].value; mbroj:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Razred'].value; razred:=nesto;
  if razred[1]='1' then razred:='prvi';
  if razred[1]='2' then razred:='drugi';
  if razred[1]='3' then razred:='treæi';
  if razred[1]='4' then razred:='èetvrti';
  nesto:=frmglavna.podaci.Recordset.fields.item['Vrsta'].value; vrsta:=nesto;

  nesto:=frmglavna.podaci2.Recordset.fields.item['Klasa'].value; klasa:=nesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['kojiput']; kojiput:=nesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['vladanje'].value; vladanje:=nesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['UrBroj'].value; urbroj:=nesto;
  frmglavna.podaci.close;
  frmglavna.podaci2.close;
  with frmglavna.rejv.ProjMan do begin
    stra:=findravecomponent('Izvjesce.Stranica',nil) as Travepage;
    komp:=FindRaveComponent('skola',stra) as TRaveText; komp.Text:=skola;
    komp:=FindRaveComponent('adresa',stra) as TRaveText; komp.Text:=aadresa;
    komp:=FindRaveComponent('klasa',stra) as TRaveText; komp.Text:=klasa;
    komp:=FindRaveComponent('urbroj',stra) as TRaveText; komp.Text:=urbroj;
    komp:=FindRaveComponent('mbroj',stra) as TRaveText; komp.Text:=mbroj;
    komp:=FindRaveComponent('ime',stra) as TRaveText; komp.Text:=nom;
    komp:=FindRaveComponent('sin',stra) as TRaveText; komp.Text:=sin;
    komp:=FindRaveComponent('kci',stra) as TRaveText; komp.Text:=kci;
    komp:=FindRaveComponent('roditelji',stra) as TRaveText; komp.Text:=roditelji;
    komp:=FindRaveComponent('rodjen',stra) as TRaveText; komp.Text:=rodjen;
    komp:=FindRaveComponent('datrod',stra) as TRaveText; komp.Text:=datrod;
    komp:=FindRaveComponent('godrod',stra) as TRaveText; komp.Text:=godrod;
    komp:=FindRaveComponent('mjdrz',stra) as TRaveText; komp.Text:=mjestorodjenja;
    komp:=FindRaveComponent('drz',stra) as TRaveText; komp.Text:=drzavljanstvo;
    komp:=FindRaveComponent('nar',stra) as TRaveText; komp.Text:=narodnost;
    komp:=FindRaveComponent('upm',stra) as TRaveText; komp.Text:=upm;
    komp:=FindRaveComponent('upz',stra) as TRaveText; komp.Text:=upz;
    komp:=FindRaveComponent('kojiput',stra) as TRaveText; komp.Text:=kojiput;
    komp:=FindRaveComponent('jezik1',stra) as TRaveText; komp.Text:=jez1;
    komp:=FindRaveComponent('jezik2',stra) as TRaveText; komp.Text:=jez2;
    komp:=FindRaveComponent('kojiraz',stra) as TRaveText; komp.Text:=razred;
    komp:=FindRaveComponent('vrsta',stra) as TRaveText; komp.Text:=vrsta;
    komp:=FindRaveComponent('postm',stra) as TRaveText; komp.Text:=postm;
    komp:=FindRaveComponent('postz',stra) as TRaveText; komp.Text:=postz;
    komp:=FindRaveComponent('vladanje',stra) as TRaveText; komp.Text:=vladanje;
    komp:=FindRaveComponent('ucdod',stra) as TRaveText; komp.Text:=ucdod;
    komp:=FindRaveComponent('nije',stra) as TRaveText; komp.Text:=nije;
    komp:=FindRaveComponent('uspjeh',stra) as TRaveText; komp.Text:=uspjeh;
    komp:=FindRaveComponent('zavz',stra) as TRaveText; komp.Text:=zavz;
    komp:=FindRaveComponent('razred',stra) as TRaveText; komp.Text:=razred;
    komp:=FindRaveComponent('ucca',stra) as TRaveText; komp.Text:=ucca;
    komp:=FindRaveComponent('ola',stra) as TRaveText; komp.Text:=ola;
    komp:=FindRaveComponent('sati',stra) as TRaveText; komp.Text:=vx;
    komp:=FindRaveComponent('neopr',stra) as TRaveText; komp.Text:=neopr;
    komp:=FindRaveComponent('gdje',stra) as TRaveText; komp.Text:=mjesto;
    komp:=FindRaveComponent('kada',stra) as TRaveText; komp.Text:=datup;
    komp:=FindRaveComponent('kojegod',stra) as TRaveText; komp.Text:=godup;
    komp:=FindRaveComponent('god1',stra) as TRaveText; komp.Text:=god1;
    komp:=FindRaveComponent('god2',stra) as TRaveText; komp.Text:=god2;

    komp:=FindRaveComponent('hrv',stra) as TRaveText; komp.Text:=hrv;
    komp:=FindRaveComponent('jez1',stra) as TRaveText; komp.Text:=eng;
    komp:=FindRaveComponent('jez2',stra) as TRaveText; komp.Text:=njem;
    komp:=FindRaveComponent('lat',stra) as TRaveText; komp.Text:=lat;
    komp:=FindRaveComponent('grc',stra) as TRaveText; komp.Text:=grc;
    komp:=FindRaveComponent('glz',stra) as TRaveText; komp.Text:=glz;
    komp:=FindRaveComponent('lik',stra) as TRaveText; komp.Text:=lik;
    komp:=FindRaveComponent('psi',stra) as TRaveText; komp.Text:=psi;
    komp:=FindRaveComponent('log',stra) as TRaveText; komp.Text:=log;
    komp:=FindRaveComponent('fil',stra) as TRaveText; komp.Text:=fil;
    komp:=FindRaveComponent('soc',stra) as TRaveText; komp.Text:=soc;
    komp:=FindRaveComponent('pov',stra) as TRaveText; komp.Text:=pov;
    komp:=FindRaveComponent('zem',stra) as TRaveText; komp.Text:=zem;
    komp:=FindRaveComponent('mat',stra) as TRaveText; komp.Text:=mat;
    komp:=FindRaveComponent('fiz',stra) as TRaveText; komp.Text:=fiz;
    komp:=FindRaveComponent('kem',stra) as TRaveText; komp.Text:=kem;
    komp:=FindRaveComponent('bio',stra) as TRaveText; komp.Text:=bio;
    komp:=FindRaveComponent('inf',stra) as TRaveText; komp.Text:=inf;
    komp:=FindRaveComponent('pig',stra) as TRaveText; komp.Text:=pig;
    komp:=FindRaveComponent('tzk',stra) as TRaveText; komp.Text:=tzk;
    komp:=FindRaveComponent('dodatni1',stra) as TRaveText; komp.Text:=dodatni1;
    komp:=FindRaveComponent('dodatni2',stra) as TRaveText; komp.Text:=dodatni2;
    komp:=FindRaveComponent('dodatni3',stra) as TRaveText; komp.Text:=dodatni3;
    komp:=FindRaveComponent('dod1',stra) as TRaveText; komp.Text:=dod1;
    komp:=FindRaveComponent('dod2',stra) as TRaveText; komp.Text:=dod2;
    komp:=FindRaveComponent('dod3',stra) as TRaveText; komp.Text:=dod3;
    komp:=FindRaveComponent('izborni1',stra) as TRaveText; komp.Text:=izborni1;
    komp:=FindRaveComponent('izborni2',stra) as TRaveText; komp.Text:=izborni2;
    komp:=FindRaveComponent('izb1',stra) as TRaveText; komp.Text:=izb1;
    komp:=FindRaveComponent('izb2',stra) as TRaveText; komp.Text:=izb2;
    komp:=FindRaveComponent('fakultativni1',stra) as TRaveText; komp.Text:=fakultativni1;
    komp:=FindRaveComponent('fakultativni2',stra) as TRaveText; komp.Text:=fakultativni2;
    komp:=FindRaveComponent('fak1',stra) as TRaveText; komp.Text:=fak1;
    komp:=FindRaveComponent('fak2',stra) as TRaveText; komp.Text:=fak2;
  end;
  frmglavna.sistem.DoNativeOutput:=false;
  frmglavna.sistem.DefaultDest:=rdpreview;
  frmglavna.sistem.SystemSetups:=frmglavna.sistem.SystemSetups - [ssAllowSetup];
  frmglavna.rejv.ExecuteReport('Izvjesce');
  frmglavna.rejv.Close;
end;

end;

procedure TfrmIspis.btDodajClick(Sender: TObject);
begin
naziv1:=lbKontrola.Items.Strings[lbRezultati.ItemIndex];
naziv2:=copy(naziv1,1,pos('*',naziv1)-1);
lbDodano.Items.Add(naziv2);
lbKontrola2.Items.add(naziv1);
if ispisovi=true then btispisdodano.Enabled:=true;
end;


procedure TfrmIspis.btIspisDodanoClick(Sender: TObject);
var v1,v2,i,c,vk,uk,brojac,j,kgj,ides:integer;
    pr:real;
    vx:string;
    neopr,upm,upz,postm,postz,ucdod,zavz,ucca,ola,sin,kci,kontk,mj,jez1,jez2:string;
    datrod,godrod,dat,datup,godup,god1,god2,km,nije,mbroj,vrsta,klasa,vladanje,urbroj,skola,adresa,aadresa,mjesto,kojiput,razred:string;
    kgod1,kgod2,vkm,raz:integer;
    nniz:array[0..1000] of string;
begin

uk:=0; brojac:=0;
ides:=lbKontrola2.Items.Count-1;
for j:=0 to ides do begin
  poc:=lbKontrola2.Items.Strings[j];
  trazeni:=copy(poc,pos('*',poc)+1,length(poc)-pos('*',poc));
  nniz[j]:=trazeni;
end;
if rbizvjesce.Checked=true then for j:=0 to ides do begin
uk:=0; brojac:=0;
  frmglavna.podaci.close;
  frmglavna.podaci.CommandText:='select * from Postavke';
  frmglavna.podaci.ExecuteOptions;
  frmglavna.podaci.Open;
  nesto:=frmglavna.podaci.Recordset.fields.item['Skola'].value; skola:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Adresa'].value; adresa:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Mjesto'].value; mjesto:=nesto;
  aadresa:=adresa+', '+mjesto;
  frmglavna.podaci.Close;
  trazeni:=nniz[j];
  frmglavna.podaci.Close;
  frmglavna.podaci.CommandText:='select * from Ucenici where ID='+trazeni;
  frmglavna.podaci.ExecuteOptions;
  frmglavna.podaci.Open;
  frmglavna.podaci2.Close;
  frmglavna.podaci2.CommandText:='select * from Polugodiste where ID='+trazeni;
  frmglavna.podaci2.ExecuteOptions;
  frmglavna.podaci2.Open;
  frmglavna.rejv.Open;
  nesto:=frmglavna.podaci.Recordset.fields.item['Ime'].value; nnesto1:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Prezime'].value; nnesto2:=nesto;
  nom:=nnesto1+' '+nnesto2;
  nesto:=frmglavna.podaci.Recordset.fields.item['JMBG'].value; nnesto:=nesto;
  jmbg:='';
  for i:=1 to length(nesto) do jmbg:=jmbg+nnesto[i]+' ';
  delete(jmbg,length(jmbg),1);
  nesto:=frmglavna.podaci.Recordset.fields.item['Spol'].value; nnesto:=nesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Opravdani'].value; nnesto1:=nesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Neopravdani'].value; nnesto2:=nesto;
  val(nnesto1,v1,c); val(nnesto2,v2,c);
  str(v1+v2,vx);
  if nnesto='M' then begin
    spol:='sin'; rodjen:='roðen'; ucenik:='Uèenik je s';
    zavrsio:='uspjehom završio prvo polugodište.';
    izostanci:='Uèenik je izostao '+vx+' sati (od toga neopravdano '+nnesto2+' sati).';
  end else begin
    spol:='kæi'; rodjen:='roðena'; ucenik:='Uèenica je s';
    zavrsio:='uspjehom završila prvo polugodište.';
    izostanci:='Uèenica je izostala '+vx+' sati (od toga neopravdano '+nnesto2+' sati).';
  end;
  nesto:=frmglavna.podaci.Recordset.fields.item['DatRod'].value; datumrodjenja:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['MjRod'].value; nnesto1:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['DrzRod'].value; nnesto2:=nesto;
  mjestorodjenja:=nnesto1+', '+nnesto2;
  nesto:=frmglavna.podaci.Recordset.fields.item['Drz'].value; drzavljanstvo:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Nar'].value; narodnost:=nesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Datum'].value; datum:=nesto;
  ocjene[1]:='nedovoljan (1)';
  ocjene[2]:='dovoljan (2)';
  ocjene[3]:='dobar (3)';
  ocjene[4]:='vrlo dobar (4)';
  ocjene[5]:='odlièan (5)';
  ned:=false;

  nesto:=frmglavna.podaci2.Recordset.fields.item['Hrv'].value;
  nnesto:=nesto; if nnesto='' then hrv:='-' else begin val(nnesto,vk,c); hrv:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['lat'].value; nnesto:=nesto; if nnesto='' then lat:='-' else begin val(nnesto,vk,c); lat:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['grc'].value; nnesto:=nesto; if nnesto='' then grc:='-' else begin val(nnesto,vk,c); grc:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['glz'].value; nnesto:=nesto; if nnesto='' then glz:='-' else begin val(nnesto,vk,c); glz:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['lik'].value; nnesto:=nesto; if nnesto='' then lik:='-' else begin val(nnesto,vk,c); lik:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['psi'].value; nnesto:=nesto; if nnesto='' then psi:='-' else begin val(nnesto,vk,c); psi:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['log'].value; nnesto:=nesto; if nnesto='' then log:='-' else begin val(nnesto,vk,c); log:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['fil'].value; nnesto:=nesto; if nnesto='' then fil:='-' else begin val(nnesto,vk,c); fil:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['soc'].value; nnesto:=nesto; if nnesto='' then soc:='-' else begin val(nnesto,vk,c); soc:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['pov'].value; nnesto:=nesto; if nnesto='' then pov:='-' else begin val(nnesto,vk,c); pov:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['zem'].value; nnesto:=nesto; if nnesto='' then zem:='-' else begin val(nnesto,vk,c); zem:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['mat'].value; nnesto:=nesto; if nnesto='' then mat:='-' else begin val(nnesto,vk,c); mat:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['fiz'].value; nnesto:=nesto; if nnesto='' then fiz:='-' else begin val(nnesto,vk,c); fiz:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['kem'].value; nnesto:=nesto; if nnesto='' then kem:='-' else begin val(nnesto,vk,c); kem:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['bio'].value; nnesto:=nesto; if nnesto='' then bio:='-' else begin val(nnesto,vk,c); bio:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['inf'].value; nnesto:=nesto; if nnesto='' then inf:='-' else begin val(nnesto,vk,c); inf:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['pig'].value; nnesto:=nesto; if nnesto='' then pig:='-' else begin val(nnesto,vk,c); pig:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['tzk'].value; nnesto:=nesto; if nnesto='' then tzk:='-' else begin val(nnesto,vk,c); tzk:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['dod1'].value; nnesto:=nesto; if nnesto='' then dod1:='-' else begin val(nnesto,vk,c); dod1:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['dod2'].value; nnesto:=nesto; if nnesto='' then dod2:='-' else begin val(nnesto,vk,c); dod2:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['dod3'].value; nnesto:=nesto; if nnesto='' then dod3:='-' else begin val(nnesto,vk,c); dod3:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['izb1'].value; nnesto:=nesto; if nnesto='' then izb1:='-' else begin val(nnesto,vk,c); izb1:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['izb2'].value; nnesto:=nesto; if nnesto='' then izb2:='-' else begin val(nnesto,vk,c); izb2:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['fak1'].value; nnesto:=nesto; if nnesto='' then fak1:='-' else begin val(nnesto,vk,c); fak1:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['fak2'].value; nnesto:=nesto; if nnesto='' then fak2:='-' else begin val(nnesto,vk,c); fak2:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['PrviJezik'].value; nnesto:=nesto;
    if nnesto<>'' then begin
    jez1:=nnesto;
    nesto:=frmglavna.podaci2.Recordset.fields.item['1jez'].value; nnesto1:=nesto;
    val(nnesto1,vk,c); eng:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true;
  end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['DrugiJezik'].value; nnesto:=nesto;
  if nnesto<>'' then begin
    jez2:=nnesto;
    nesto:=frmglavna.podaci2.Recordset.fields.item['2jez'].value; nnesto1:=nesto;
    val(nnesto1,vk,c); njem:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true;
  end;

  nesto:=frmglavna.podaci2.Recordset.fields.item['Dodatni1'].value; nnesto:=nesto; if nnesto='' then nnesto:='-'; dodatni1:=nnesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Dodatni2'].value; nnesto:=nesto; if nnesto='' then nnesto:='-'; dodatni2:=nnesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Dodatni3'].value; nnesto:=nesto; if nnesto='' then nnesto:='-'; dodatni3:=nnesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Izborni1'].value; nnesto:=nesto; if nnesto='' then nnesto:='-'; izborni1:=nnesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Izborni2'].value; nnesto:=nesto; if nnesto='' then nnesto:='-'; izborni2:=nnesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Fakultativni1'].value; nnesto:=nesto; if nnesto='' then nnesto:='-'; fakultativni1:=nnesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Fakultativni2'].value; nnesto:=nesto; if nnesto='' then nnesto:='-'; fakultativni2:=nnesto;
  pr:=uk/brojac;
  if pr>=4.5 then uspjeh:='odliènim';
  if (pr<4.5) and (pr>=3.5) then uspjeh:='vrlo dobrim';
  if (pr<3.5) and (pr>=2.5) then uspjeh:='dobrim';
  if (pr<2.5) and (pr>=1.5) then uspjeh:='dovoljnim';
  if ned=true then uspjeh:='nedovoljnim';
  nesto:=frmglavna.podaci.Recordset.fields.item['Imeoca'].value; nnesto1:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Imemajke'].value; nnesto2:=nesto;
  roditelji:=nnesto1+' i '+nnesto2;

  with frmglavna.rejv.ProjMan do begin
    stra:=findravecomponent('Izvjesce.Stranica',nil) as Travepage;
    komp:=FindRaveComponent('Skola',stra) as TRaveText; komp.Text:=skola;
    komp:=FindRaveComponent('Adresa',stra) as TRaveText; komp.Text:=aadresa;
    komp:=FindRaveComponent('Ime',stra) as TRaveText; komp.Text:=nom;
    komp:=FindRaveComponent('JMBG',stra) as TRaveText; komp.Text:=jmbg;
    komp:=FindRaveComponent('Spol',stra) as TRaveText; komp.Text:=spol;
    komp:=FindRaveComponent('Roditelji',stra) as TRaveText; komp.Text:=roditelji;
    komp:=FindRaveComponent('Rodjen',stra) as TRaveText; komp.Text:=rodjen;
    komp:=FindRaveComponent('DatumRodjenja',stra) as TRaveText; komp.Text:=datumrodjenja;
    komp:=FindRaveComponent('Mjestorodjenja',stra) as TRaveText; komp.Text:=mjestorodjenja;
    komp:=FindRaveComponent('Drzavljanstvo',stra) as TRaveText; komp.Text:=drzavljanstvo;
    komp:=FindRaveComponent('Narodnost',stra) as TRaveText; komp.Text:=narodnost;
    komp:=FindRaveComponent('hrv',stra) as TRaveText; komp.Text:=hrv;
    komp:=FindRaveComponent('eng',stra) as TRaveText; komp.Text:=eng;
    komp:=FindRaveComponent('njem',stra) as TRaveText; komp.Text:=njem;
    komp:=FindRaveComponent('lat',stra) as TRaveText; komp.Text:=lat;
    komp:=FindRaveComponent('grc',stra) as TRaveText; komp.Text:=grc;
    komp:=FindRaveComponent('glz',stra) as TRaveText; komp.Text:=glz;
    komp:=FindRaveComponent('lik',stra) as TRaveText; komp.Text:=lik;
    komp:=FindRaveComponent('psi',stra) as TRaveText; komp.Text:=psi;
    komp:=FindRaveComponent('log',stra) as TRaveText; komp.Text:=log;
    komp:=FindRaveComponent('fil',stra) as TRaveText; komp.Text:=fil;
    komp:=FindRaveComponent('soc',stra) as TRaveText; komp.Text:=soc;
    komp:=FindRaveComponent('pov',stra) as TRaveText; komp.Text:=pov;
    komp:=FindRaveComponent('zem',stra) as TRaveText; komp.Text:=zem;
    komp:=FindRaveComponent('mat',stra) as TRaveText; komp.Text:=mat;
    komp:=FindRaveComponent('fiz',stra) as TRaveText; komp.Text:=fiz;
    komp:=FindRaveComponent('kem',stra) as TRaveText; komp.Text:=kem;
    komp:=FindRaveComponent('bio',stra) as TRaveText; komp.Text:=bio;
    komp:=FindRaveComponent('inf',stra) as TRaveText; komp.Text:=inf;
    komp:=FindRaveComponent('pig',stra) as TRaveText; komp.Text:=pig;
    komp:=FindRaveComponent('tzk',stra) as TRaveText; komp.Text:=tzk;
    komp:=FindRaveComponent('dodatni1',stra) as TRaveText; komp.Text:=dodatni1;
    komp:=FindRaveComponent('dodatni2',stra) as TRaveText; komp.Text:=dodatni2;
    komp:=FindRaveComponent('dodatni3',stra) as TRaveText; komp.Text:=dodatni3;
    komp:=FindRaveComponent('dod1',stra) as TRaveText; komp.Text:=dod1;
    komp:=FindRaveComponent('dod2',stra) as TRaveText; komp.Text:=dod2;
    komp:=FindRaveComponent('dod3',stra) as TRaveText; komp.Text:=dod3;
    komp:=FindRaveComponent('izborni1',stra) as TRaveText; komp.Text:=izborni1;
    komp:=FindRaveComponent('izborni2',stra) as TRaveText; komp.Text:=izborni2;
    komp:=FindRaveComponent('izb1',stra) as TRaveText; komp.Text:=izb1;
    komp:=FindRaveComponent('izb2',stra) as TRaveText; komp.Text:=izb2;
    komp:=FindRaveComponent('fakultativni1',stra) as TRaveText; komp.Text:=fakultativni1;
    komp:=FindRaveComponent('fakultativni2',stra) as TRaveText; komp.Text:=fakultativni2;
    komp:=FindRaveComponent('fak1',stra) as TRaveText; komp.Text:=fak1;
    komp:=FindRaveComponent('fak2',stra) as TRaveText; komp.Text:=fak2;
    komp:=FindRaveComponent('ucenik',stra) as TRaveText; komp.Text:=ucenik;
    komp:=FindRaveComponent('uspjeh',stra) as TRaveText; komp.Text:=uspjeh;
    komp:=FindRaveComponent('zavrsio',stra) as TRaveText; komp.Text:=zavrsio;
    komp:=FindRaveComponent('izostanci',stra) as TRaveText; komp.Text:=izostanci;
    komp:=FindRaveComponent('datum',stra) as TRaveText; komp.Text:=datum;
  end;
  frmglavna.sistem.DoNativeOutput:=false;
  frmglavna.sistem.DefaultDest:=rdpreview;
  frmglavna.sistem.SystemSetups:=frmglavna.sistem.SystemSetups - [ssAllowSetup];
  frmglavna.rejv.ExecuteReport('Izvjesce');
  frmglavna.rejv.Close;
end;

if rbmatura.Checked=true then for j:=0 to ides do begin
  frmglavna.podaci.close;
  frmglavna.podaci.CommandText:='select * from Postavke';
  frmglavna.podaci.ExecuteOptions;
  frmglavna.podaci.Open;
  nesto:=frmglavna.podaci.Recordset.fields.item['Skola'].value; skola:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Adresa'].value; adresa:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Mjesto'].value; mjesto:=nesto;
  aadresa:=adresa+', '+mjesto;
  trazeni:=nniz[j];
  frmglavna.podaci.Close;
  frmglavna.rejv.ProjectFile:='matura1.rav';
  frmglavna.rejv2.ProjectFile:='matura2.rav';

  frmglavna.podaci.CommandText:='select * from Ucenici where ID='+trazeni;
  frmglavna.podaci.ExecuteOptions;
  frmglavna.podaci.Open;
  frmglavna.podaci2.Close;
  frmglavna.podaci2.CommandText:='select * from Matura where ID='+trazeni;
  frmglavna.podaci2.ExecuteOptions;
  frmglavna.podaci2.Open;
if frmglavna.podaci2.RecordCount>0 then begin
  frmglavna.rejv.Open;
  frmglavna.rejv2.Open;

  nesto:=frmglavna.podaci.Recordset.fields.item['Ime'].value; nnesto1:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Prezime'].value; nnesto2:=nesto;
  nom:=nnesto1+' '+nnesto2;
  nesto:=frmglavna.podaci.Recordset.fields.item['JMBG'].value; nnesto:=nesto;
  jmbg:=nnesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Spol'].value; nnesto:=nesto;
  if nnesto='M' then begin
    kci:='---'; sin:=''; rodjen:='-';
    olam1:='';olam2:='';olam3:='';olam4:='';olam5:='';
    olaz1:='-';olaz2:='-';olaz3:='-';olaz4:='-';olaz5:='-';
    ca1:='--'; ca2:='--'; ca3:='--';
    k1:='';k2:='';k3:='';
  end else begin
    kci:=''; sin:='---'; rodjen:='';
    olam1:='-';olam2:='-';olam3:='-';olam4:='-';olam5:='-';
    olaz1:='';olaz2:='';olaz3:='';olaz4:='';olaz5:='';
    ca1:=''; ca2:=''; ca3:='';
    k1:='-';k2:='-';k3:='-';
  end;
  nesto:=frmglavna.podaci.Recordset.fields.item['DatRod'].value; datumrodjenja:=nesto;
  kontk:=copy(datumrodjenja,4,2);
  if kontk='01' then mj:='sijeènja';
  if kontk='02' then mj:='veljaèe';
  if kontk='03' then mj:='ožujka';
  if kontk='04' then mj:='travnja';
  if kontk='05' then mj:='svibnja';
  if kontk='06' then mj:='lipnja';
  if kontk='07' then mj:='srpnja';
  if kontk='08' then mj:='kolovoza';
  if kontk='09' then mj:='rujna';
  if kontk='10' then mj:='listopada';
  if kontk='11' then mj:='studenog';
  if kontk='12' then mj:='prosinca';
  kontk:=copy(datumrodjenja,1,3);
  if kontk[1]='0' then delete(kontk,1,1);
  datrod:=kontk+' '+mj;
  godrod:=datumrodjenja[9]+datumrodjenja[10];

  nesto:=frmglavna.podaci.Recordset.fields.item['DatRod'].value; datumrodjenja:=nesto;
  kontk:=copy(datumrodjenja,4,2);
  if kontk='01' then mj:='sijeènja';
  if kontk='02' then mj:='veljaèe';
  if kontk='03' then mj:='ožujka';
  if kontk='04' then mj:='travnja';
  if kontk='05' then mj:='svibnja';
  if kontk='06' then mj:='lipnja';
  if kontk='07' then mj:='srpnja';
  if kontk='08' then mj:='kolovoza';
  if kontk='09' then mj:='rujna';
  if kontk='10' then mj:='listopada';
  if kontk='11' then mj:='studenog';
  if kontk='12' then mj:='prosinca';
  kontk:=copy(datumrodjenja,1,3);
  if kontk[1]='0' then delete(kontk,1,1);
  datt:=kontk+' '+mj;
  godd:=datumrodjenja[9]+datumrodjenja[10];


  nesto:=frmglavna.podaci.Recordset.fields.item['Datupisa'].value; dat:=nesto;
  kontk:=copy(dat,4,2);
  if kontk='01' then mj:='sijeènja';
  if kontk='02' then mj:='veljaèe';
  if kontk='03' then mj:='ožujka';
  if kontk='04' then mj:='travnja';
  if kontk='05' then mj:='svibnja';
  if kontk='06' then mj:='lipnja';
  if kontk='07' then mj:='srpnja';
  if kontk='08' then mj:='kolovoza';
  if kontk='09' then mj:='rujna';
  if kontk='10' then mj:='listopada';
  if kontk='11' then mj:='studenog';
  if kontk='12' then mj:='prosinca';
  kontk:=copy(dat,1,3);
  if kontk[1]='0' then delete(kontk,1,1);
  god:=dat[7]+dat[8]+dat[9]+dat[10]+'.';
  datupisa:=kontk+' '+mj+' '+god;

  nesto:=frmglavna.podaci2.Recordset.fields.item['Od'].value; dat:=nesto;
  kontk:=copy(dat,4,2);
  if kontk='01' then mj:='sijeènja';
  if kontk='02' then mj:='veljaèe';
  if kontk='03' then mj:='ožujka';
  if kontk='04' then mj:='travnja';
  if kontk='05' then mj:='svibnja';
  if kontk='06' then mj:='lipnja';
  if kontk='07' then mj:='srpnja';
  if kontk='08' then mj:='kolovoza';
  if kontk='09' then mj:='rujna';
  if kontk='10' then mj:='listopada';
  if kontk='11' then mj:='studenog';
  if kontk='12' then mj:='prosinca';
  kontk:=copy(dat,1,3);
  if kontk[1]='0' then delete(kontk,1,1);
  god:=dat[7]+dat[8]+dat[9]+dat[10]+'.';
  datod:=kontk+' '+mj+' '+god;

  nesto:=frmglavna.podaci2.Recordset.fields.item['Do'].value; dat:=nesto;
  kontk:=copy(dat,4,2);
  if kontk='01' then mj:='sijeènja';
  if kontk='02' then mj:='veljaèe';
  if kontk='03' then mj:='ožujka';
  if kontk='04' then mj:='travnja';
  if kontk='05' then mj:='svibnja';
  if kontk='06' then mj:='lipnja';
  if kontk='07' then mj:='srpnja';
  if kontk='08' then mj:='kolovoza';
  if kontk='09' then mj:='rujna';
  if kontk='10' then mj:='listopada';
  if kontk='11' then mj:='studenog';
  if kontk='12' then mj:='prosinca';
  kontk:=copy(dat,1,3);
  if kontk[1]='0' then delete(kontk,1,1);
  god:=dat[7]+dat[8]+dat[9]+dat[10]+'.';
  datdo:=kontk+' '+mj+' '+god;


  nesto:=frmglavna.podaci.Recordset.fields.item['Datupisa'].value; dat:=nesto;
  km:=dat[7]+dat[8]+dat[9]+dat[10];
  val(km,vkm,c);
  nesto:=frmglavna.podaci.Recordset.fields.item['Razred'].value; dat:=nesto;
  val(dat[1],raz,c);
  kgod1:=(raz-1)+vkm;
  kgod2:=kgod1+1;
  str(kgod1,god1);
  str(kgod2,god2);
  nesto:=frmglavna.podaci.Recordset.fields.item['MjRod'].value; nnesto1:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['DrzRod'].value; nnesto2:=nesto;
  mjestorodjenja:=nnesto1+', '+nnesto2;
  nesto:=frmglavna.podaci.Recordset.fields.item['Drz'].value; drzavljanstvo:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Nar'].value; narodnost:=nesto;
  ocjene[2]:='dovoljan (2)';
  ocjene[3]:='dobar (3)';
  ocjene[4]:='vrlo dobar (4)';
  ocjene[5]:='odlièan (5)';
  nesto:=frmglavna.podaci2.Recordset.fields.item['mat'].value; bmat:=nesto;
  val(bmat,am,c); if am<>0 then mat:=ocjene[am] else mat:='-';
  nesto:=frmglavna.podaci2.Recordset.fields.item['hrv'].value; bmat:=nesto;
  val(bmat,ah,c); if ah<>0 then hrv:=ocjene[ah] else hrv:='-';
  nesto:=frmglavna.podaci2.Recordset.fields.item['izb1'].value; bmat:=nesto;
  val(bmat,a1,c); if a1<>0 then izb1:=ocjene[a1] else izb1:='-';
  nesto:=frmglavna.podaci2.Recordset.fields.item['izb2'].value; bmat:=nesto;
  val(bmat,a2,c); if a2<>0 then izb2:=ocjene[a2] else izb2:='-';
  nesto:=frmglavna.podaci2.Recordset.fields.item['izborni1'].value; bmat:=nesto;
  if bmat<>'' then izborni1:=bmat else izborni1:='-';
  nesto:=frmglavna.podaci2.Recordset.fields.item['izborni2'].value; bmat:=nesto;
  if bmat<>'' then izborni2:=bmat else izborni2:='-';
  nesto:=frmglavna.podaci2.Recordset.fields.item['osl'].value; bmat:=nesto;
  if bmat='DA' then uspjeh:=mat else begin
    pr:=(ah+am+a1+a2)/4;
    if pr>=4.5 then uspjeh:='odlièan (5)';
    if (pr<4.5) and (pr>=3.5) then uspjeh:='vrlo dobar (4)';
    if (pr<3.5) and (pr>=2.5) then uspjeh:='dobar (3)';
    if (pr<2.5) and (pr>=1.5) then uspjeh:='dovoljan (2)';
  end;
  nesto:=frmglavna.podaci.Recordset.fields.item['Imeoca'].value; nnesto1:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Imemajke'].value; nnesto2:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Isprava'].value; isprava:=nesto;
  roditelji:=nnesto1+' i '+nnesto2;
  nesto:=frmglavna.podaci.Recordset.fields.item['MBroj'].value; mbroj:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Vrsta'].value; vrsta:=nesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Klasa'].value; klasa:=nesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['UrBroj'].value; urbroj:=nesto;
  frmglavna.podaci.close;
  frmglavna.podaci2.close;
  with frmglavna.rejv.ProjMan do begin
    stra:=findravecomponent('Report1.Page1',nil) as Travepage;
    komp:=FindRaveComponent('skola',stra) as TRaveText; komp.Text:=skola;
    komp:=FindRaveComponent('adresa',stra) as TRaveText; komp.Text:=aadresa;
    komp:=FindRaveComponent('klasa',stra) as TRaveText; komp.Text:=klasa;
    komp:=FindRaveComponent('urbroj',stra) as TRaveText; komp.Text:=urbroj;
    komp:=FindRaveComponent('mbroj',stra) as TRaveText; komp.Text:=mbroj;
  end;
  with frmglavna.rejv2.ProjMan do begin
    stra:=findravecomponent('Report1.Page1',nil) as Travepage;
    komp:=FindRaveComponent('ime',stra) as TRaveText; komp.Text:=nom;

    komp:=FindRaveComponent('olam1',stra) as TRaveText; komp.Text:=olam1;
    komp:=FindRaveComponent('olaz1',stra) as TRaveText; komp.Text:=olaz1;
    komp:=FindRaveComponent('olam2',stra) as TRaveText; komp.Text:=olam2;
    komp:=FindRaveComponent('olaz2',stra) as TRaveText; komp.Text:=olaz2;
    komp:=FindRaveComponent('olam3',stra) as TRaveText; komp.Text:=olam3;
    komp:=FindRaveComponent('olaz3',stra) as TRaveText; komp.Text:=olaz3;
    komp:=FindRaveComponent('olam4',stra) as TRaveText; komp.Text:=olam4;
    komp:=FindRaveComponent('olaz4',stra) as TRaveText; komp.Text:=olaz4;
    komp:=FindRaveComponent('olam5',stra) as TRaveText; komp.Text:=olam5;
    komp:=FindRaveComponent('olaz5',stra) as TRaveText; komp.Text:=olaz5;
    komp:=FindRaveComponent('ca1',stra) as TRaveText; komp.Text:=ca1;
    komp:=FindRaveComponent('ca2',stra) as TRaveText; komp.Text:=ca2;
    komp:=FindRaveComponent('ca3',stra) as TRaveText; komp.Text:=ca3;
    komp:=FindRaveComponent('k1',stra) as TRaveText; komp.Text:=k1;
    komp:=FindRaveComponent('k2',stra) as TRaveText; komp.Text:=k2;
    komp:=FindRaveComponent('k3',stra) as TRaveText; komp.Text:=k3;
    komp:=FindRaveComponent('kci',stra) as TRaveText; komp.Text:=kci;
    komp:=FindRaveComponent('sin',stra) as TRaveText; komp.Text:=sin;
    komp:=FindRaveComponent('rodjen',stra) as TRaveText; komp.Text:=rodjen;

    komp:=FindRaveComponent('roditelji',stra) as TRaveText; komp.Text:=roditelji;
    komp:=FindRaveComponent('datrod',stra) as TRaveText; komp.Text:=datrod;
    komp:=FindRaveComponent('godrod',stra) as TRaveText; komp.Text:=godrod;
    komp:=FindRaveComponent('mjdrz',stra) as TRaveText; komp.Text:=mjestorodjenja;
    komp:=FindRaveComponent('drz',stra) as TRaveText; komp.Text:=drzavljanstvo;
    komp:=FindRaveComponent('nar',stra) as TRaveText; komp.Text:=narodnost;
    komp:=FindRaveComponent('isprava',stra) as TRaveText; komp.Text:=isprava;
    komp:=FindRaveComponent('datupisa',stra) as TRaveText; komp.Text:=datupisa;
    komp:=FindRaveComponent('vrsta',stra) as TRaveText; komp.Text:=vrsta;
    komp:=FindRaveComponent('datmat',stra) as TRaveText; komp.Text:=datdo;
    komp:=FindRaveComponent('od',stra) as TRaveText; komp.Text:=datod;
    komp:=FindRaveComponent('do',stra) as TRaveText; komp.Text:=datdo;
    komp:=FindRaveComponent('mat',stra) as TRaveText; komp.Text:=mat;
    komp:=FindRaveComponent('hrv',stra) as TRaveText; komp.Text:=hrv;
    komp:=FindRaveComponent('izb1',stra) as TRaveText; komp.Text:=izb1;
    komp:=FindRaveComponent('izb2',stra) as TRaveText; komp.Text:=izb2;
    komp:=FindRaveComponent('izborni1',stra) as TRaveText; komp.Text:=izborni1;
    komp:=FindRaveComponent('izborni2',stra) as TRaveText; komp.Text:=izborni2;
    komp:=FindRaveComponent('uspjeh',stra) as TRaveText; komp.Text:=uspjeh;
    komp:=FindRaveComponent('mjesto',stra) as TRaveText; komp.Text:=mjesto;
    komp:=FindRaveComponent('dat',stra) as TRaveText; komp.Text:=datt;
    komp:=FindRaveComponent('god',stra) as TRaveText; komp.Text:=godd;
  end;
  frmglavna.sistem.DoNativeOutput:=false;
  frmglavna.sistem.DefaultDest:=rdprinter;
  frmglavna.sistem.SystemSetups:=frmglavna.sistem.SystemSetups - [ssAllowSetup];
  frmglavna.rejv.ExecuteReport('Report1');
  frmglavna.rejv.Close;
  application.MessageBox('Molim, okrenite stranu...', 'Registar - ispis maturalne svjedodžbe', mb_OK);
  frmglavna.rejv2.ExecuteReport('Report1');
  frmglavna.rejv2.Close;
end else begin
  if kgj=0 then application.MessageBox('Neki uèenici nemaju podatke o maturi.', 'Registar - ispis maturalne svjedodžbe', mb_OK);
  kgj:=1;
end;
end;
if rbsvjedodzba.Checked=true then for j:=0 to ides do begin
  frmglavna.podaci.close;
  frmglavna.podaci.CommandText:='select * from Postavke';
  frmglavna.podaci.ExecuteOptions;
  frmglavna.podaci.Open;
  nesto:=frmglavna.podaci.Recordset.fields.item['Skola'].value; skola:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Adresa'].value; adresa:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Mjesto'].value; mjesto:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['SkGod'].value; sss:=nesto;
  aadresa:=adresa+', '+mjesto;
  trazeni:=nniz[j];
  frmglavna.podaci.Close;
  frmglavna.rejv.ProjectFile:='svjedodzba.rav';
  frmglavna.podaci.CommandText:='select * from Ucenici where ID='+trazeni;
  frmglavna.podaci.ExecuteOptions;
  frmglavna.podaci.Open;
  frmglavna.podaci2.Close;
  frmglavna.podaci2.CommandText:='select * from Kraj where ID='+trazeni;
  frmglavna.podaci2.ExecuteOptions;
  frmglavna.podaci2.Open;
  frmglavna.rejv.Open;
  nesto:=frmglavna.podaci.Recordset.fields.item['Ime'].value; nnesto1:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Prezime'].value; nnesto2:=nesto;
  nom:=nnesto1+' '+nnesto2;
  nesto:=frmglavna.podaci.Recordset.fields.item['JMBG'].value; nnesto:=nesto;
  jmbg:=nnesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Spol'].value; nnesto:=nesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Opravdani'].value; nnesto1:=nesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Neopravdani'].value; nnesto2:=nesto;
  val(nnesto1,v1,c); val(nnesto2,v2,c); neopr:=nnesto2;
  str(v1+v2,vx);
  if nnesto='M' then begin
    sin:='--'; kci:=''; rodjen:='';
    upm:='-'; upz:='';
    postm:='-'; postz:='';
    ucdod:='k'; zavz:='o';
    ucca:='k'; ola:='o';
  end else begin
    sin:=''; kci:='--'; rodjen:='a';
    upm:='-'; upz:='-';
    postm:=''; postz:='-';
    ucdod:='ca'; zavz:='la';
    ucca:='ca'; ola:='la';
  end;
  nesto:=frmglavna.podaci.Recordset.fields.item['DatRod'].value; datumrodjenja:=nesto;
  kontk:=copy(datumrodjenja,4,2);
  if kontk='01' then mj:='sijeènja';
  if kontk='02' then mj:='veljaèe';
  if kontk='03' then mj:='ožujka';
  if kontk='04' then mj:='travnja';
  if kontk='05' then mj:='svibnja';
  if kontk='06' then mj:='lipnja';
  if kontk='07' then mj:='srpnja';
  if kontk='08' then mj:='kolovoza';
  if kontk='09' then mj:='rujna';
  if kontk='10' then mj:='listopada';
  if kontk='11' then mj:='studenog';
  if kontk='12' then mj:='prosinca';
  kontk:=copy(datumrodjenja,1,3);
  if kontk[1]='0' then delete(kontk,1,1);
  datrod:=kontk+' '+mj;
  godrod:=datumrodjenja[9]+datumrodjenja[10];

  nesto:=frmglavna.podaci2.Recordset.fields.item['Datum'].value; dat:=nesto;
  kontk:=copy(dat,4,2);
  if kontk='01' then mj:='sijeènja';
  if kontk='02' then mj:='veljaèe';
  if kontk='03' then mj:='ožujka';
  if kontk='04' then mj:='travnja';
  if kontk='05' then mj:='svibnja';
  if kontk='06' then mj:='lipnja';
  if kontk='07' then mj:='srpnja';
  if kontk='08' then mj:='kolovoza';
  if kontk='09' then mj:='rujna';
  if kontk='10' then mj:='listopada';
  if kontk='11' then mj:='studenog';
  if kontk='12' then mj:='prosinca';
  kontk:=copy(dat,1,3);
  if kontk[1]='0' then delete(kontk,1,1);
  datup:=kontk+' '+mj;
  godup:=dat[9]+dat[10];
  nesto:=frmglavna.podaci.Recordset.fields.item['Datupisa'].value; dat:=nesto;
  km:=dat[7]+dat[8]+dat[9]+dat[10];
  val(km,vkm,c);
  nesto:=frmglavna.podaci.Recordset.fields.item['Razred'].value; dat:=nesto;
  val(dat[1],raz,c);
  kgod1:=(raz-1)+vkm;
  kgod2:=kgod1+1;
   god1:=sss[1]+sss[2]+sss[3]+sss[4]+sss[5];
  god2:=sss[7]+sss[8]+sss[9]+sss[10]+sss[11];
  nesto:=frmglavna.podaci.Recordset.fields.item['MjRod'].value; nnesto1:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['DrzRod'].value; nnesto2:=nesto;
  mjestorodjenja:=nnesto1+', '+nnesto2;
  nesto:=frmglavna.podaci.Recordset.fields.item['Drz'].value; drzavljanstvo:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Nar'].value; narodnost:=nesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Datum'].value; datum:=nesto;
  ocjene[1]:='nedovoljan (1)';
  ocjene[2]:='dovoljan (2)';
  ocjene[3]:='dobar (3)';
  ocjene[4]:='vrlo dobar (4)';
  ocjene[5]:='odlièan (5)';
  ned:=false;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Hrv'].value; nnesto:=nesto; if nnesto='' then hrv:='-' else begin val(nnesto,vk,c); hrv:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['lat'].value; nnesto:=nesto; if nnesto='' then lat:='-' else begin val(nnesto,vk,c); lat:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['grc'].value; nnesto:=nesto; if nnesto='' then grc:='-' else begin val(nnesto,vk,c); grc:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['glz'].value; nnesto:=nesto; if nnesto='' then glz:='-' else begin val(nnesto,vk,c); glz:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['lik'].value; nnesto:=nesto; if nnesto='' then lik:='-' else begin val(nnesto,vk,c); lik:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['psi'].value; nnesto:=nesto; if nnesto='' then psi:='-' else begin val(nnesto,vk,c); psi:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['log'].value; nnesto:=nesto; if nnesto='' then log:='-' else begin val(nnesto,vk,c); log:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['fil'].value; nnesto:=nesto; if nnesto='' then fil:='-' else begin val(nnesto,vk,c); fil:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['soc'].value; nnesto:=nesto; if nnesto='' then soc:='-' else begin val(nnesto,vk,c); soc:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['pov'].value; nnesto:=nesto; if nnesto='' then pov:='-' else begin val(nnesto,vk,c); pov:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['zem'].value; nnesto:=nesto; if nnesto='' then zem:='-' else begin val(nnesto,vk,c); zem:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['mat'].value; nnesto:=nesto; if nnesto='' then mat:='-' else begin val(nnesto,vk,c); mat:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['fiz'].value; nnesto:=nesto; if nnesto='' then fiz:='-' else begin val(nnesto,vk,c); fiz:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['kem'].value; nnesto:=nesto; if nnesto='' then kem:='-' else begin val(nnesto,vk,c); kem:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['bio'].value; nnesto:=nesto; if nnesto='' then bio:='-' else begin val(nnesto,vk,c); bio:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['inf'].value; nnesto:=nesto; if nnesto='' then inf:='-' else begin val(nnesto,vk,c); inf:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['pig'].value; nnesto:=nesto; if nnesto='' then pig:='-' else begin val(nnesto,vk,c); pig:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['tzk'].value; nnesto:=nesto; if nnesto='' then tzk:='-' else begin val(nnesto,vk,c); tzk:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['dod1'].value; nnesto:=nesto; if nnesto='' then dod1:='-' else begin val(nnesto,vk,c); dod1:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['dod2'].value; nnesto:=nesto; if nnesto='' then dod2:='-' else begin val(nnesto,vk,c); dod2:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['dod3'].value; nnesto:=nesto; if nnesto='' then dod3:='-' else begin val(nnesto,vk,c); dod3:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['izb1'].value; nnesto:=nesto; if nnesto='' then izb1:='-' else begin val(nnesto,vk,c); izb1:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['izb2'].value; nnesto:=nesto; if nnesto='' then izb2:='-' else begin val(nnesto,vk,c); izb2:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['fak1'].value; nnesto:=nesto; if nnesto='' then fak1:='-' else begin val(nnesto,vk,c); fak1:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['fak2'].value; nnesto:=nesto; if nnesto='' then fak2:='-' else begin val(nnesto,vk,c); fak2:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['PrviJezik'].value; nnesto:=nesto;
   if nnesto<>'' then begin
    jez1:=nnesto;
    nesto:=frmglavna.podaci2.Recordset.fields.item['1jez'].value; nnesto1:=nesto;
    val(nnesto1,vk,c); eng:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true;
  end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['DrugiJezik'].value; nnesto:=nesto;
  if nnesto<>'' then begin
    jez2:=nnesto;
    nesto:=frmglavna.podaci2.Recordset.fields.item['2jez'].value; nnesto1:=nesto;
    val(nnesto1,vk,c); njem:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true;
  end;

  nesto:=frmglavna.podaci2.Recordset.fields.item['Dodatni1'].value; nnesto:=nesto; if nnesto='' then nnesto:='-'; dodatni1:=nnesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Dodatni2'].value; nnesto:=nesto; if nnesto='' then nnesto:='-'; dodatni2:=nnesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Dodatni3'].value; nnesto:=nesto; if nnesto='' then nnesto:='-'; dodatni3:=nnesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Izborni1'].value; nnesto:=nesto; if nnesto='' then nnesto:='-'; izborni1:=nnesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Izborni2'].value; nnesto:=nesto; if nnesto='' then nnesto:='-'; izborni2:=nnesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Fakultativni1'].value; nnesto:=nesto; if nnesto='' then nnesto:='-'; fakultativni1:=nnesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Fakultativni2'].value; nnesto:=nesto; if nnesto='' then nnesto:='-'; fakultativni2:=nnesto;
  pr:=uk/brojac;
  if pr>=4.5 then uspjeh:='odliènim';
  if (pr<4.5) and (pr>=3.5) then uspjeh:='vrlo dobrim';
  if (pr<3.5) and (pr>=2.5) then uspjeh:='dobrim';
  if (pr<2.5) and (pr>=1.5) then uspjeh:='dovoljnim';
  nije:='';
  if ned=true then begin uspjeh:='prolaznim'; nije:='ni'; end;
  nesto:=frmglavna.podaci.Recordset.fields.item['Imeoca'].value; nnesto1:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Imemajke'].value; nnesto2:=nesto;
  roditelji:=nnesto1+' i '+nnesto2;
  nesto:=frmglavna.podaci.Recordset.fields.item['MBroj'].value; mbroj:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Razred'].value; razred:=nesto;
  if razred[1]='1' then razred:='prvi';
  if razred[1]='2' then razred:='drugi';
  if razred[1]='3' then razred:='treæi';
  if razred[1]='4' then razred:='èetvrti';
  nesto:=frmglavna.podaci.Recordset.fields.item['Vrsta'].value; vrsta:=nesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['kojiput']; kojiput:=nesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Klasa'].value; klasa:=nesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['vladanje'].value; vladanje:=nesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['UrBroj'].value; urbroj:=nesto;
  frmglavna.podaci.close;
  frmglavna.podaci2.close;
  with frmglavna.rejv.ProjMan do begin
    stra:=findravecomponent('Izvjesce.Stranica',nil) as Travepage;
    komp:=FindRaveComponent('skola',stra) as TRaveText; komp.Text:=skola;
    komp:=FindRaveComponent('adresa',stra) as TRaveText; komp.Text:=aadresa;
    komp:=FindRaveComponent('klasa',stra) as TRaveText; komp.Text:=klasa;
    komp:=FindRaveComponent('urbroj',stra) as TRaveText; komp.Text:=urbroj;
    komp:=FindRaveComponent('mbroj',stra) as TRaveText; komp.Text:=mbroj;
    komp:=FindRaveComponent('ime',stra) as TRaveText; komp.Text:=nom;

    komp:=FindRaveComponent('sin',stra) as TRaveText; komp.Text:=sin;
    komp:=FindRaveComponent('kci',stra) as TRaveText; komp.Text:=kci;
    komp:=FindRaveComponent('roditelji',stra) as TRaveText; komp.Text:=roditelji;
    komp:=FindRaveComponent('rodjen',stra) as TRaveText; komp.Text:=rodjen;
    komp:=FindRaveComponent('datrod',stra) as TRaveText; komp.Text:=datrod;
    komp:=FindRaveComponent('godrod',stra) as TRaveText; komp.Text:=godrod;
    komp:=FindRaveComponent('mjdrz',stra) as TRaveText; komp.Text:=mjestorodjenja;
    komp:=FindRaveComponent('drz',stra) as TRaveText; komp.Text:=drzavljanstvo;
    komp:=FindRaveComponent('nar',stra) as TRaveText; komp.Text:=narodnost;
    komp:=FindRaveComponent('upm',stra) as TRaveText; komp.Text:=upm;
    komp:=FindRaveComponent('upz',stra) as TRaveText; komp.Text:=upz;
    komp:=FindRaveComponent('kojiput',stra) as TRaveText; komp.Text:=kojiput;
    komp:=FindRaveComponent('kojiraz',stra) as TRaveText; komp.Text:=razred;
        komp:=FindRaveComponent('jezik1',stra) as TRaveText; komp.Text:=jez1;
    komp:=FindRaveComponent('jezik2',stra) as TRaveText; komp.Text:=jez2;
    komp:=FindRaveComponent('vrsta',stra) as TRaveText; komp.Text:=vrsta;
    komp:=FindRaveComponent('postm',stra) as TRaveText; komp.Text:=postm;
    komp:=FindRaveComponent('postz',stra) as TRaveText; komp.Text:=postz;
    komp:=FindRaveComponent('vladanje',stra) as TRaveText; komp.Text:=vladanje;
    komp:=FindRaveComponent('ucdod',stra) as TRaveText; komp.Text:=ucdod;
    komp:=FindRaveComponent('nije',stra) as TRaveText; komp.Text:=nije;
    komp:=FindRaveComponent('uspjeh',stra) as TRaveText; komp.Text:=uspjeh;
    komp:=FindRaveComponent('zavz',stra) as TRaveText; komp.Text:=zavz;
    komp:=FindRaveComponent('razred',stra) as TRaveText; komp.Text:=razred;
    komp:=FindRaveComponent('ucca',stra) as TRaveText; komp.Text:=ucca;
    komp:=FindRaveComponent('ola',stra) as TRaveText; komp.Text:=ola;
    komp:=FindRaveComponent('sati',stra) as TRaveText; komp.Text:=vx;
    komp:=FindRaveComponent('neopr',stra) as TRaveText; komp.Text:=neopr;
    komp:=FindRaveComponent('gdje',stra) as TRaveText; komp.Text:=mjesto;
    komp:=FindRaveComponent('kada',stra) as TRaveText; komp.Text:=datup;
    komp:=FindRaveComponent('kojegod',stra) as TRaveText; komp.Text:=godup;
    komp:=FindRaveComponent('god1',stra) as TRaveText; komp.Text:=god1;
    komp:=FindRaveComponent('god2',stra) as TRaveText; komp.Text:=god2;

    komp:=FindRaveComponent('hrv',stra) as TRaveText; komp.Text:=hrv;
    komp:=FindRaveComponent('jez1',stra) as TRaveText; komp.Text:=eng;
    komp:=FindRaveComponent('jez2',stra) as TRaveText; komp.Text:=njem;
    komp:=FindRaveComponent('lat',stra) as TRaveText; komp.Text:=lat;
    komp:=FindRaveComponent('grc',stra) as TRaveText; komp.Text:=grc;
    komp:=FindRaveComponent('glz',stra) as TRaveText; komp.Text:=glz;
    komp:=FindRaveComponent('lik',stra) as TRaveText; komp.Text:=lik;
    komp:=FindRaveComponent('psi',stra) as TRaveText; komp.Text:=psi;
    komp:=FindRaveComponent('log',stra) as TRaveText; komp.Text:=log;
    komp:=FindRaveComponent('fil',stra) as TRaveText; komp.Text:=fil;
    komp:=FindRaveComponent('soc',stra) as TRaveText; komp.Text:=soc;
    komp:=FindRaveComponent('pov',stra) as TRaveText; komp.Text:=pov;
    komp:=FindRaveComponent('zem',stra) as TRaveText; komp.Text:=zem;
    komp:=FindRaveComponent('mat',stra) as TRaveText; komp.Text:=mat;
    komp:=FindRaveComponent('fiz',stra) as TRaveText; komp.Text:=fiz;
    komp:=FindRaveComponent('kem',stra) as TRaveText; komp.Text:=kem;
    komp:=FindRaveComponent('bio',stra) as TRaveText; komp.Text:=bio;
    komp:=FindRaveComponent('inf',stra) as TRaveText; komp.Text:=inf;
    komp:=FindRaveComponent('pig',stra) as TRaveText; komp.Text:=pig;
    komp:=FindRaveComponent('tzk',stra) as TRaveText; komp.Text:=tzk;
    komp:=FindRaveComponent('dodatni1',stra) as TRaveText; komp.Text:=dodatni1;
    komp:=FindRaveComponent('dodatni2',stra) as TRaveText; komp.Text:=dodatni2;
    komp:=FindRaveComponent('dodatni3',stra) as TRaveText; komp.Text:=dodatni3;
    komp:=FindRaveComponent('dod1',stra) as TRaveText; komp.Text:=dod1;
    komp:=FindRaveComponent('dod2',stra) as TRaveText; komp.Text:=dod2;
    komp:=FindRaveComponent('dod3',stra) as TRaveText; komp.Text:=dod3;
    komp:=FindRaveComponent('izborni1',stra) as TRaveText; komp.Text:=izborni1;
    komp:=FindRaveComponent('izborni2',stra) as TRaveText; komp.Text:=izborni2;
    komp:=FindRaveComponent('izb1',stra) as TRaveText; komp.Text:=izb1;
    komp:=FindRaveComponent('izb2',stra) as TRaveText; komp.Text:=izb2;
    komp:=FindRaveComponent('fakultativni1',stra) as TRaveText; komp.Text:=fakultativni1;
    komp:=FindRaveComponent('fakultativni2',stra) as TRaveText; komp.Text:=fakultativni2;
    komp:=FindRaveComponent('fak1',stra) as TRaveText; komp.Text:=fak1;
    komp:=FindRaveComponent('fak2',stra) as TRaveText; komp.Text:=fak2;
  end;
  frmglavna.sistem.DoNativeOutput:=false;
  frmglavna.sistem.DefaultDest:=rdprinter;
  frmglavna.sistem.SystemSetups:=frmglavna.sistem.SystemSetups - [ssAllowSetup];
  frmglavna.rejv.ExecuteReport('Izvjesce');
  frmglavna.rejv.Close;
end;



end;

procedure TfrmIspis.btPregledajClick(Sender: TObject);
var v1,v2,i,c,vk,uk,brojac:integer;
    pr:real;
    vx,skola,aadresa,adresa,mjesto,jez1,jez2:string;
begin
uk:=0; brojac:=0;
if rbizvjesce.Checked=true then begin
frmglavna.podaci.close;
  frmglavna.podaci.CommandText:='select * from Postavke';
  frmglavna.podaci.ExecuteOptions;
  frmglavna.podaci.Open;
  nesto:=frmglavna.podaci.Recordset.fields.item['Skola'].value; skola:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Adresa'].value; adresa:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Mjesto'].value; mjesto:=nesto;
  aadresa:=adresa+', '+mjesto;
  frmglavna.podaci.Close;
  poc:=lbKontrola.Items.Strings[lbRezultati.ItemIndex];
  trazeni:=copy(poc,pos('*',poc)+1,length(poc)-pos('*',poc));
  frmglavna.podaci.Close;
  frmglavna.podaci.CommandText:='select * from Ucenici where ID='+trazeni;
  frmglavna.podaci.ExecuteOptions;
  frmglavna.podaci.Open;
  frmglavna.podaci2.Close;
  frmglavna.podaci2.CommandText:='select * from Polugodiste where ID='+trazeni;
  frmglavna.podaci2.ExecuteOptions;
  frmglavna.podaci2.Open;
  frmglavna.rejv.Open;
  nesto:=frmglavna.podaci.Recordset.fields.item['Ime'].value; nnesto1:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Prezime'].value; nnesto2:=nesto;
  nom:=nnesto1+' '+nnesto2;
  nesto:=frmglavna.podaci.Recordset.fields.item['JMBG'].value; nnesto:=nesto;
  jmbg:='';
  for i:=1 to length(nesto) do jmbg:=jmbg+nnesto[i]+' ';
  delete(jmbg,length(jmbg),1);
  nesto:=frmglavna.podaci.Recordset.fields.item['Spol'].value; nnesto:=nesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Opravdani'].value; nnesto1:=nesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Neopravdani'].value; nnesto2:=nesto;
  val(nnesto1,v1,c); val(nnesto2,v2,c);
  str(v1+v2,vx);
  if nnesto='M' then begin
    spol:='sin'; rodjen:='roðen'; ucenik:='Uèenik je s';
    zavrsio:='uspjehom završio prvo polugodište.';
    izostanci:='Uèenik je izostao '+vx+' sati (od toga neopravdano '+nnesto2+' sati).';
  end else begin
    spol:='kæi'; rodjen:='roðena'; ucenik:='Uèenica je s';
    zavrsio:='uspjehom završila prvo polugodište.';
    izostanci:='Uèenica je izostala '+vx+' sati (od toga neopravdano '+nnesto2+' sati).';
  end;
  nesto:=frmglavna.podaci.Recordset.fields.item['DatRod'].value; datumrodjenja:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['MjRod'].value; nnesto1:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['DrzRod'].value; nnesto2:=nesto;
  mjestorodjenja:=nnesto1+', '+nnesto2;
  nesto:=frmglavna.podaci.Recordset.fields.item['Drz'].value; drzavljanstvo:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Nar'].value; narodnost:=nesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Datum'].value; datum:=nesto;
  ocjene[1]:='nedovoljan (1)';
  ocjene[2]:='dovoljan (2)';
  ocjene[3]:='dobar (3)';
  ocjene[4]:='vrlo dobar (4)';
  ocjene[5]:='odlièan (5)';
  ned:=false;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Hrv'].value; nnesto:=nesto; if nnesto='' then hrv:='-' else begin val(nnesto,vk,c); hrv:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['lat'].value; nnesto:=nesto; if nnesto='' then lat:='-' else begin val(nnesto,vk,c); lat:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['grc'].value; nnesto:=nesto; if nnesto='' then grc:='-' else begin val(nnesto,vk,c); grc:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['glz'].value; nnesto:=nesto; if nnesto='' then glz:='-' else begin val(nnesto,vk,c); glz:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['lik'].value; nnesto:=nesto; if nnesto='' then lik:='-' else begin val(nnesto,vk,c); lik:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['psi'].value; nnesto:=nesto; if nnesto='' then psi:='-' else begin val(nnesto,vk,c); psi:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['log'].value; nnesto:=nesto; if nnesto='' then log:='-' else begin val(nnesto,vk,c); log:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['fil'].value; nnesto:=nesto; if nnesto='' then fil:='-' else begin val(nnesto,vk,c); fil:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['soc'].value; nnesto:=nesto; if nnesto='' then soc:='-' else begin val(nnesto,vk,c); soc:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['pov'].value; nnesto:=nesto; if nnesto='' then pov:='-' else begin val(nnesto,vk,c); pov:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['zem'].value; nnesto:=nesto; if nnesto='' then zem:='-' else begin val(nnesto,vk,c); zem:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['mat'].value; nnesto:=nesto; if nnesto='' then mat:='-' else begin val(nnesto,vk,c); mat:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['fiz'].value; nnesto:=nesto; if nnesto='' then fiz:='-' else begin val(nnesto,vk,c); fiz:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['kem'].value; nnesto:=nesto; if nnesto='' then kem:='-' else begin val(nnesto,vk,c); kem:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['bio'].value; nnesto:=nesto; if nnesto='' then bio:='-' else begin val(nnesto,vk,c); bio:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['inf'].value; nnesto:=nesto; if nnesto='' then inf:='-' else begin val(nnesto,vk,c); inf:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['pig'].value; nnesto:=nesto; if nnesto='' then pig:='-' else begin val(nnesto,vk,c); pig:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['tzk'].value; nnesto:=nesto; if nnesto='' then tzk:='-' else begin val(nnesto,vk,c); tzk:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['dod1'].value; nnesto:=nesto; if nnesto='' then dod1:='-' else begin val(nnesto,vk,c); dod1:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['dod2'].value; nnesto:=nesto; if nnesto='' then dod2:='-' else begin val(nnesto,vk,c); dod2:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['dod3'].value; nnesto:=nesto; if nnesto='' then dod3:='-' else begin val(nnesto,vk,c); dod3:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['izb1'].value; nnesto:=nesto; if nnesto='' then izb1:='-' else begin val(nnesto,vk,c); izb1:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['izb2'].value; nnesto:=nesto; if nnesto='' then izb2:='-' else begin val(nnesto,vk,c); izb2:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['fak1'].value; nnesto:=nesto; if nnesto='' then fak1:='-' else begin val(nnesto,vk,c); fak1:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['fak2'].value; nnesto:=nesto; if nnesto='' then fak2:='-' else begin val(nnesto,vk,c); fak2:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['PrviJezik'].value; nnesto:=nesto;
    if nnesto<>'' then begin
    jez1:=nnesto;
    nesto:=frmglavna.podaci2.Recordset.fields.item['1jez'].value; nnesto1:=nesto;
    val(nnesto1,vk,c); eng:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true;
  end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['DrugiJezik'].value; nnesto:=nesto;
  if nnesto<>'' then begin
    jez2:=nnesto;
    nesto:=frmglavna.podaci2.Recordset.fields.item['2jez'].value; nnesto1:=nesto;
    val(nnesto1,vk,c); njem:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true;
  end;

  nesto:=frmglavna.podaci2.Recordset.fields.item['Dodatni1'].value; nnesto:=nesto; if nnesto='' then nnesto:='-'; dodatni1:=nnesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Dodatni2'].value; nnesto:=nesto; if nnesto='' then nnesto:='-'; dodatni2:=nnesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Dodatni3'].value; nnesto:=nesto; if nnesto='' then nnesto:='-'; dodatni3:=nnesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Izborni1'].value; nnesto:=nesto; if nnesto='' then nnesto:='-'; izborni1:=nnesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Izborni2'].value; nnesto:=nesto; if nnesto='' then nnesto:='-'; izborni2:=nnesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Fakultativni1'].value; nnesto:=nesto; if nnesto='' then nnesto:='-'; fakultativni1:=nnesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Fakultativni2'].value; nnesto:=nesto; if nnesto='' then nnesto:='-'; fakultativni2:=nnesto;
  pr:=uk/brojac;
  if pr>=4.5 then uspjeh:='odliènim';
  if (pr<4.5) and (pr>=3.5) then uspjeh:='vrlo dobrim';
  if (pr<3.5) and (pr>=2.5) then uspjeh:='dobrim';
  if (pr<2.5) and (pr>=1.5) then uspjeh:='dovoljnim';
  if ned=true then uspjeh:='nedovoljnim';
  nesto:=frmglavna.podaci.Recordset.fields.item['Imeoca'].value; nnesto1:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Imemajke'].value; nnesto2:=nesto;
  roditelji:=nnesto1+' i '+nnesto2;

  with frmglavna.rejv.ProjMan do begin
    stra:=findravecomponent('Izvjesce.Stranica',nil) as Travepage;
    komp:=FindRaveComponent('skola',stra) as TRaveText; komp.Text:=skola;
    komp:=FindRaveComponent('adresa',stra) as TRaveText; komp.Text:=aadresa;
    komp:=FindRaveComponent('Ime',stra) as TRaveText; komp.Text:=nom;
    komp:=FindRaveComponent('JMBG',stra) as TRaveText; komp.Text:=jmbg;
    komp:=FindRaveComponent('Spol',stra) as TRaveText; komp.Text:=spol;
    komp:=FindRaveComponent('Roditelji',stra) as TRaveText; komp.Text:=roditelji;
    komp:=FindRaveComponent('Rodjen',stra) as TRaveText; komp.Text:=rodjen;
    komp:=FindRaveComponent('DatumRodjenja',stra) as TRaveText; komp.Text:=datumrodjenja;
    komp:=FindRaveComponent('Mjestorodjenja',stra) as TRaveText; komp.Text:=mjestorodjenja;
    komp:=FindRaveComponent('Drzavljanstvo',stra) as TRaveText; komp.Text:=drzavljanstvo;
    komp:=FindRaveComponent('Narodnost',stra) as TRaveText; komp.Text:=narodnost;
    komp:=FindRaveComponent('hrv',stra) as TRaveText; komp.Text:=hrv;
    komp:=FindRaveComponent('eng',stra) as TRaveText; komp.Text:=eng;
    komp:=FindRaveComponent('njem',stra) as TRaveText; komp.Text:=njem;
    komp:=FindRaveComponent('lat',stra) as TRaveText; komp.Text:=lat;
    komp:=FindRaveComponent('grc',stra) as TRaveText; komp.Text:=grc;
    komp:=FindRaveComponent('glz',stra) as TRaveText; komp.Text:=glz;
    komp:=FindRaveComponent('lik',stra) as TRaveText; komp.Text:=lik;
    komp:=FindRaveComponent('psi',stra) as TRaveText; komp.Text:=psi;
    komp:=FindRaveComponent('log',stra) as TRaveText; komp.Text:=log;
    komp:=FindRaveComponent('fil',stra) as TRaveText; komp.Text:=fil;
    komp:=FindRaveComponent('soc',stra) as TRaveText; komp.Text:=soc;
    komp:=FindRaveComponent('pov',stra) as TRaveText; komp.Text:=pov;
    komp:=FindRaveComponent('zem',stra) as TRaveText; komp.Text:=zem;
    komp:=FindRaveComponent('mat',stra) as TRaveText; komp.Text:=mat;
    komp:=FindRaveComponent('fiz',stra) as TRaveText; komp.Text:=fiz;
    komp:=FindRaveComponent('kem',stra) as TRaveText; komp.Text:=kem;
    komp:=FindRaveComponent('bio',stra) as TRaveText; komp.Text:=bio;
    komp:=FindRaveComponent('inf',stra) as TRaveText; komp.Text:=inf;
    komp:=FindRaveComponent('pig',stra) as TRaveText; komp.Text:=pig;
    komp:=FindRaveComponent('tzk',stra) as TRaveText; komp.Text:=tzk;
    komp:=FindRaveComponent('dodatni1',stra) as TRaveText; komp.Text:=dodatni1;
    komp:=FindRaveComponent('dodatni2',stra) as TRaveText; komp.Text:=dodatni2;
    komp:=FindRaveComponent('dodatni3',stra) as TRaveText; komp.Text:=dodatni3;
    komp:=FindRaveComponent('dod1',stra) as TRaveText; komp.Text:=dod1;
    komp:=FindRaveComponent('dod2',stra) as TRaveText; komp.Text:=dod2;
    komp:=FindRaveComponent('dod3',stra) as TRaveText; komp.Text:=dod3;
    komp:=FindRaveComponent('izborni1',stra) as TRaveText; komp.Text:=izborni1;
    komp:=FindRaveComponent('izborni2',stra) as TRaveText; komp.Text:=izborni2;
    komp:=FindRaveComponent('izb1',stra) as TRaveText; komp.Text:=izb1;
    komp:=FindRaveComponent('izb2',stra) as TRaveText; komp.Text:=izb2;
    komp:=FindRaveComponent('fakultativni1',stra) as TRaveText; komp.Text:=fakultativni1;
    komp:=FindRaveComponent('fakultativni2',stra) as TRaveText; komp.Text:=fakultativni2;
    komp:=FindRaveComponent('fak1',stra) as TRaveText; komp.Text:=fak1;
    komp:=FindRaveComponent('fak2',stra) as TRaveText; komp.Text:=fak2;
    komp:=FindRaveComponent('ucenik',stra) as TRaveText; komp.Text:=ucenik;
    komp:=FindRaveComponent('uspjeh',stra) as TRaveText; komp.Text:=uspjeh;
    komp:=FindRaveComponent('zavrsio',stra) as TRaveText; komp.Text:=zavrsio;
    komp:=FindRaveComponent('izostanci',stra) as TRaveText; komp.Text:=izostanci;
    komp:=FindRaveComponent('datum',stra) as TRaveText; komp.Text:=datum;
  end;
  frmglavna.sistem.DefaultDest:=rdPreview;
  frmglavna.sistem.DoNativeOutput:=false;
  frmglavna.sistem.SystemSetups:=frmglavna.sistem.SystemSetups - [ssAllowSetup];
  frmglavna.rejv.ExecuteReport('Izvjesce');
  frmglavna.rejv.Close;
end;
end;

procedure TfrmIspis.FormActivate(Sender: TObject);
begin
rbizvjesce.Checked:=false;
rbsvjedodzba.Checked:=false;
rbmatura.Checked:=false;
cbrazred.Text:='';
cbrazred2.Text:='';
edmbroj.Text:='';
edime.Text:='';
edprezime.Text:='';
edjmbg.Text:='';
lbdodano.Clear; lbrezultati.Clear; lbkontrola.Clear; lbkontrola2.Clear;
btdodaj.Enabled:=false;
btpregledaj.Enabled:=false;
btispisipretraga.Enabled:=false;
btispisrazred.Enabled:=false;
btispisdodano.Enabled:=false;
btizbaci.Enabled:=false;
frmGlavna.Caption:='Registar - Ispis dokumenata';
cbrazred.Clear; cbrazred2.Clear;
frmglavna.podaci3.Close;
frmglavna.podaci3.CommandText:='select * from Razredi order by ime';
frmglavna.podaci3.ExecuteOptions;
frmglavna.podaci3.Open;
frmglavna.podaci3.Recordset.MoveFirst;
while not (frmglavna.podaci3.Recordset.eof) do begin
  nesto:=frmglavna.podaci3.Recordset.fields.item['Ime'].value; if nesto<> null then nnesto:=nesto;
  if nnesto<>'' then begin cbrazred.Items.add(nnesto); cbrazred2.Items.add(nnesto); end;
  frmglavna.podaci3.Recordset.MoveNext;
end;
edmbroj.SetFocus;
end;


procedure TfrmIspis.btOdustaniClick(Sender: TObject);
begin
frmGlavna.Caption:='Registar';
frmPrijelaz.FormStyle:=fsMDIChild;
frmPrijelaz.WindowState:=wsMaximized;
end;


procedure TfrmIspis.btIzbaciClick(Sender: TObject);
var xp:integer;
begin
xp:=lbDodano.itemindex;
lbDodano.Items.Delete(xp);
lbKontrola2.Items.Delete(xp);
if xp=lbDodano.items.Count then lbDodano.ItemIndex:=lbDodano.items.Count-1 else lbDodano.ItemIndex:=xp;
if lbdodano.Items.count=0 then begin btizbaci.Enabled:=false; btispisdodano.Enabled:=false; end;
end;

procedure TfrmIspis.btIspisRazredClick(Sender: TObject);
var v1,v2,i,c,vk,uk,brojac,kgj:integer;
    pr:real;
    vx,kkk:string;
    neopr,upm,upz,postm,postz,ucdod,zavz,ucca,ola,sin,kci,kontk,mj,jez1,jez2:string;
    datrod,godrod,dat,datup,godup,god1,god2,km,nije,mbroj,vrsta,klasa,vladanje,urbroj,skola,adresa,aadresa,mjesto,kojiput,razred:string;
    kgod1,kgod2,vkm,raz:integer;
begin
kkk:=cbRazred2.Text;
frmglavna.podaci.Close;
frmglavna.podaci.CommandText:='select * from Ucenici where Razred='+chr(39)+kkk+chr(39);
frmglavna.podaci.ExecuteOptions;
frmglavna.podaci.Open;
if rbizvjesce.Checked=true then begin
while not (frmglavna.podaci.Recordset.eof) do begin
if rbizvjesce.Checked=true then begin
frmglavna.podaci.close;
  frmglavna.podaci.CommandText:='select * from Postavke';
  frmglavna.podaci.ExecuteOptions;
  frmglavna.podaci.Open;
  nesto:=frmglavna.podaci.Recordset.fields.item['Skola'].value; skola:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Adresa'].value; adresa:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Mjesto'].value; mjesto:=nesto;
  aadresa:=adresa+', '+mjesto;
  frmglavna.podaci.Close;
  uk:=0; brojac:=0;
  nesto:=frmglavna.podaci.Recordset.fields.item['ID'].value; trazeni:=nesto;
  frmglavna.podaci2.Close;
  frmglavna.podaci2.CommandText:='select * from Polugodiste where ID='+trazeni;
  frmglavna.podaci2.ExecuteOptions;
  frmglavna.podaci2.Open;
  frmglavna.rejv.Open;
  nesto:=frmglavna.podaci.Recordset.fields.item['Ime'].value; nnesto1:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Prezime'].value; nnesto2:=nesto;
  nom:=nnesto1+' '+nnesto2;
  nesto:=frmglavna.podaci.Recordset.fields.item['JMBG'].value; nnesto:=nesto;
  jmbg:='';
  for i:=1 to length(nesto) do jmbg:=jmbg+nnesto[i]+' ';
  delete(jmbg,length(jmbg),1);
  nesto:=frmglavna.podaci.Recordset.fields.item['Spol'].value; nnesto:=nesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Opravdani'].value; nnesto1:=nesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Neopravdani'].value; nnesto2:=nesto;
  val(nnesto1,v1,c); val(nnesto2,v2,c);
  str(v1+v2,vx);
  if nnesto='M' then begin
    spol:='sin'; rodjen:='roðen'; ucenik:='Uèenik je s';
    zavrsio:='uspjehom završio prvo polugodište.';
    izostanci:='Uèenik je izostao '+vx+' sati (od toga neopravdano '+nnesto2+' sati).';
  end else begin
    spol:='kæi'; rodjen:='roðena'; ucenik:='Uèenica je s';
    zavrsio:='uspjehom završila prvo polugodište.';
    izostanci:='Uèenica je izostala '+vx+' sati (od toga neopravdano '+nnesto2+' sati).';
  end;
  nesto:=frmglavna.podaci.Recordset.fields.item['DatRod'].value; datumrodjenja:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['MjRod'].value; nnesto1:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['DrzRod'].value; nnesto2:=nesto;
  mjestorodjenja:=nnesto1+', '+nnesto2;
  nesto:=frmglavna.podaci.Recordset.fields.item['Drz'].value; drzavljanstvo:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Nar'].value; narodnost:=nesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Datum'].value; datum:=nesto;
  ocjene[1]:='nedovoljan (1)';
  ocjene[2]:='dovoljan (2)';
  ocjene[3]:='dobar (3)';
  ocjene[4]:='vrlo dobar (4)';
  ocjene[5]:='odlièan (5)';
  ned:=false;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Hrv'].value; nnesto:=nesto; if nnesto='' then hrv:='-' else begin val(nnesto,vk,c); hrv:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['lat'].value; nnesto:=nesto; if nnesto='' then lat:='-' else begin val(nnesto,vk,c); lat:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['grc'].value; nnesto:=nesto; if nnesto='' then grc:='-' else begin val(nnesto,vk,c); grc:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['glz'].value; nnesto:=nesto; if nnesto='' then glz:='-' else begin val(nnesto,vk,c); glz:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['lik'].value; nnesto:=nesto; if nnesto='' then lik:='-' else begin val(nnesto,vk,c); lik:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['psi'].value; nnesto:=nesto; if nnesto='' then psi:='-' else begin val(nnesto,vk,c); psi:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['log'].value; nnesto:=nesto; if nnesto='' then log:='-' else begin val(nnesto,vk,c); log:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['fil'].value; nnesto:=nesto; if nnesto='' then fil:='-' else begin val(nnesto,vk,c); fil:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['soc'].value; nnesto:=nesto; if nnesto='' then soc:='-' else begin val(nnesto,vk,c); soc:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['pov'].value; nnesto:=nesto; if nnesto='' then pov:='-' else begin val(nnesto,vk,c); pov:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['zem'].value; nnesto:=nesto; if nnesto='' then zem:='-' else begin val(nnesto,vk,c); zem:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['mat'].value; nnesto:=nesto; if nnesto='' then mat:='-' else begin val(nnesto,vk,c); mat:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['fiz'].value; nnesto:=nesto; if nnesto='' then fiz:='-' else begin val(nnesto,vk,c); fiz:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['kem'].value; nnesto:=nesto; if nnesto='' then kem:='-' else begin val(nnesto,vk,c); kem:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['bio'].value; nnesto:=nesto; if nnesto='' then bio:='-' else begin val(nnesto,vk,c); bio:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['inf'].value; nnesto:=nesto; if nnesto='' then inf:='-' else begin val(nnesto,vk,c); inf:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['pig'].value; nnesto:=nesto; if nnesto='' then pig:='-' else begin val(nnesto,vk,c); pig:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['tzk'].value; nnesto:=nesto; if nnesto='' then tzk:='-' else begin val(nnesto,vk,c); tzk:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['dod1'].value; nnesto:=nesto; if nnesto='' then dod1:='-' else begin val(nnesto,vk,c); dod1:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['dod2'].value; nnesto:=nesto; if nnesto='' then dod2:='-' else begin val(nnesto,vk,c); dod2:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['dod3'].value; nnesto:=nesto; if nnesto='' then dod3:='-' else begin val(nnesto,vk,c); dod3:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['izb1'].value; nnesto:=nesto; if nnesto='' then izb1:='-' else begin val(nnesto,vk,c); izb1:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['izb2'].value; nnesto:=nesto; if nnesto='' then izb2:='-' else begin val(nnesto,vk,c); izb2:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['fak1'].value; nnesto:=nesto; if nnesto='' then fak1:='-' else begin val(nnesto,vk,c); fak1:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['fak2'].value; nnesto:=nesto; if nnesto='' then fak2:='-' else begin val(nnesto,vk,c); fak2:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['PrviJezik'].value; nnesto:=nesto;
   if nnesto<>'' then begin
    jez1:=nnesto;
    nesto:=frmglavna.podaci2.Recordset.fields.item['1jez'].value; nnesto1:=nesto;
    val(nnesto1,vk,c); eng:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true;
  end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['DrugiJezik'].value; nnesto:=nesto;
  if nnesto<>'' then begin
    jez2:=nnesto;
    nesto:=frmglavna.podaci2.Recordset.fields.item['2jez'].value; nnesto1:=nesto;
    val(nnesto1,vk,c); njem:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true;
  end;

  nesto:=frmglavna.podaci2.Recordset.fields.item['Dodatni1'].value; nnesto:=nesto; if nnesto='' then nnesto:='-'; dodatni1:=nnesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Dodatni2'].value; nnesto:=nesto; if nnesto='' then nnesto:='-'; dodatni2:=nnesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Dodatni3'].value; nnesto:=nesto; if nnesto='' then nnesto:='-'; dodatni3:=nnesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Izborni1'].value; nnesto:=nesto; if nnesto='' then nnesto:='-'; izborni1:=nnesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Izborni2'].value; nnesto:=nesto; if nnesto='' then nnesto:='-'; izborni2:=nnesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Fakultativni1'].value; nnesto:=nesto; if nnesto='' then nnesto:='-'; fakultativni1:=nnesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Fakultativni2'].value; nnesto:=nesto; if nnesto='' then nnesto:='-'; fakultativni2:=nnesto;
  pr:=uk/brojac;
  if pr>=4.5 then uspjeh:='odliènim';
  if (pr<4.5) and (pr>=3.5) then uspjeh:='vrlo dobrim';
  if (pr<3.5) and (pr>=2.5) then uspjeh:='dobrim';
  if (pr<2.5) and (pr>=1.5) then uspjeh:='dovoljnim';
  if ned=true then uspjeh:='nedovoljnim';
  nesto:=frmglavna.podaci.Recordset.fields.item['Imeoca'].value; nnesto1:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Imemajke'].value; nnesto2:=nesto;
  roditelji:=nnesto1+' i '+nnesto2;
  with frmglavna.rejv.ProjMan do begin
    stra:=findravecomponent('Izvjesce.Stranica',nil) as Travepage;
    komp:=FindRaveComponent('Ime',stra) as TRaveText; komp.Text:=nom;
    komp:=FindRaveComponent('skola',stra) as TRaveText; komp.Text:=skola;
    komp:=FindRaveComponent('adresa',stra) as TRaveText; komp.Text:=aadresa;
    komp:=FindRaveComponent('JMBG',stra) as TRaveText; komp.Text:=jmbg;
    komp:=FindRaveComponent('Spol',stra) as TRaveText; komp.Text:=spol;
    komp:=FindRaveComponent('Roditelji',stra) as TRaveText; komp.Text:=roditelji;
    komp:=FindRaveComponent('Rodjen',stra) as TRaveText; komp.Text:=rodjen;
    komp:=FindRaveComponent('DatumRodjenja',stra) as TRaveText; komp.Text:=datumrodjenja;
    komp:=FindRaveComponent('Mjestorodjenja',stra) as TRaveText; komp.Text:=mjestorodjenja;
    komp:=FindRaveComponent('Drzavljanstvo',stra) as TRaveText; komp.Text:=drzavljanstvo;
    komp:=FindRaveComponent('Narodnost',stra) as TRaveText; komp.Text:=narodnost;
    komp:=FindRaveComponent('hrv',stra) as TRaveText; komp.Text:=hrv;
    komp:=FindRaveComponent('eng',stra) as TRaveText; komp.Text:=eng;
    komp:=FindRaveComponent('njem',stra) as TRaveText; komp.Text:=njem;
    komp:=FindRaveComponent('lat',stra) as TRaveText; komp.Text:=lat;
    komp:=FindRaveComponent('grc',stra) as TRaveText; komp.Text:=grc;
    komp:=FindRaveComponent('glz',stra) as TRaveText; komp.Text:=glz;
    komp:=FindRaveComponent('lik',stra) as TRaveText; komp.Text:=lik;
    komp:=FindRaveComponent('psi',stra) as TRaveText; komp.Text:=psi;
    komp:=FindRaveComponent('log',stra) as TRaveText; komp.Text:=log;
    komp:=FindRaveComponent('fil',stra) as TRaveText; komp.Text:=fil;
    komp:=FindRaveComponent('soc',stra) as TRaveText; komp.Text:=soc;
    komp:=FindRaveComponent('pov',stra) as TRaveText; komp.Text:=pov;
    komp:=FindRaveComponent('zem',stra) as TRaveText; komp.Text:=zem;
    komp:=FindRaveComponent('mat',stra) as TRaveText; komp.Text:=mat;
    komp:=FindRaveComponent('fiz',stra) as TRaveText; komp.Text:=fiz;
    komp:=FindRaveComponent('kem',stra) as TRaveText; komp.Text:=kem;
    komp:=FindRaveComponent('bio',stra) as TRaveText; komp.Text:=bio;
    komp:=FindRaveComponent('inf',stra) as TRaveText; komp.Text:=inf;
    komp:=FindRaveComponent('pig',stra) as TRaveText; komp.Text:=pig;
    komp:=FindRaveComponent('tzk',stra) as TRaveText; komp.Text:=tzk;
    komp:=FindRaveComponent('dodatni1',stra) as TRaveText; komp.Text:=dodatni1;
    komp:=FindRaveComponent('dodatni2',stra) as TRaveText; komp.Text:=dodatni2;
    komp:=FindRaveComponent('dodatni3',stra) as TRaveText; komp.Text:=dodatni3;
    komp:=FindRaveComponent('dod1',stra) as TRaveText; komp.Text:=dod1;
    komp:=FindRaveComponent('dod2',stra) as TRaveText; komp.Text:=dod2;
    komp:=FindRaveComponent('dod3',stra) as TRaveText; komp.Text:=dod3;
    komp:=FindRaveComponent('izborni1',stra) as TRaveText; komp.Text:=izborni1;
    komp:=FindRaveComponent('izborni2',stra) as TRaveText; komp.Text:=izborni2;
    komp:=FindRaveComponent('izb1',stra) as TRaveText; komp.Text:=izb1;
    komp:=FindRaveComponent('izb2',stra) as TRaveText; komp.Text:=izb2;
    komp:=FindRaveComponent('fakultativni1',stra) as TRaveText; komp.Text:=fakultativni1;
    komp:=FindRaveComponent('fakultativni2',stra) as TRaveText; komp.Text:=fakultativni2;
    komp:=FindRaveComponent('fak1',stra) as TRaveText; komp.Text:=fak1;
    komp:=FindRaveComponent('fak2',stra) as TRaveText; komp.Text:=fak2;
    komp:=FindRaveComponent('ucenik',stra) as TRaveText; komp.Text:=ucenik;
    komp:=FindRaveComponent('uspjeh',stra) as TRaveText; komp.Text:=uspjeh;
    komp:=FindRaveComponent('zavrsio',stra) as TRaveText; komp.Text:=zavrsio;
    komp:=FindRaveComponent('izostanci',stra) as TRaveText; komp.Text:=izostanci;
    komp:=FindRaveComponent('datum',stra) as TRaveText; komp.Text:=datum;
  end;
  frmglavna.sistem.DefaultDest:=rdPrinter;
  frmglavna.sistem.DoNativeOutput:=false;
  frmglavna.sistem.SystemSetups:=frmglavna.sistem.SystemSetups - [ssAllowSetup];
  frmglavna.rejv.ExecuteReport('Izvjesce');
  frmglavna.rejv.Close;
  frmglavna.podaci.Recordset.MoveNext;
end;
end;

if rbmatura.Checked=true then begin
  nesto:=frmglavna.podaci.Recordset.fields.item['ID'].value; trazeni:=nesto;
  frmglavna.podaci.close;
  frmglavna.podaci.CommandText:='select * from Postavke';
  frmglavna.podaci.ExecuteOptions;
  frmglavna.podaci.Open;
  nesto:=frmglavna.podaci.Recordset.fields.item['Skola'].value; skola:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Adresa'].value; adresa:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Mjesto'].value; mjesto:=nesto;
  aadresa:=adresa+', '+mjesto;


  frmglavna.podaci.Close;
  frmglavna.rejv.ProjectFile:='matura1.rav';
  frmglavna.rejv2.ProjectFile:='matura2.rav';

  frmglavna.podaci.CommandText:='select * from Ucenici where ID='+trazeni;
  frmglavna.podaci.ExecuteOptions;
  frmglavna.podaci.Open;
  frmglavna.podaci2.Close;
  frmglavna.podaci2.CommandText:='select * from Matura where ID='+trazeni;
  frmglavna.podaci2.ExecuteOptions;
  frmglavna.podaci2.Open;
if frmglavna.podaci2.RecordCount>0 then begin
  frmglavna.rejv.Open;
  frmglavna.rejv2.Open;

  nesto:=frmglavna.podaci.Recordset.fields.item['Ime'].value; nnesto1:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Prezime'].value; nnesto2:=nesto;
  nom:=nnesto1+' '+nnesto2;
  nesto:=frmglavna.podaci.Recordset.fields.item['JMBG'].value; nnesto:=nesto;
  jmbg:=nnesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Spol'].value; nnesto:=nesto;
  if nnesto='M' then begin
    kci:='---'; sin:=''; rodjen:='-';
    olam1:='';olam2:='';olam3:='';olam4:='';olam5:='';
    olaz1:='-';olaz2:='-';olaz3:='-';olaz4:='-';olaz5:='-';
    ca1:='--'; ca2:='--'; ca3:='--';
    k1:='';k2:='';k3:='';
  end else begin
    kci:=''; sin:='---'; rodjen:='';
    olam1:='-';olam2:='-';olam3:='-';olam4:='-';olam5:='-';
    olaz1:='';olaz2:='';olaz3:='';olaz4:='';olaz5:='';
    ca1:=''; ca2:=''; ca3:='';
    k1:='-';k2:='-';k3:='-';
  end;
  nesto:=frmglavna.podaci.Recordset.fields.item['DatRod'].value; datumrodjenja:=nesto;
  kontk:=copy(datumrodjenja,4,2);
  if kontk='01' then mj:='sijeènja';
  if kontk='02' then mj:='veljaèe';
  if kontk='03' then mj:='ožujka';
  if kontk='04' then mj:='travnja';
  if kontk='05' then mj:='svibnja';
  if kontk='06' then mj:='lipnja';
  if kontk='07' then mj:='srpnja';
  if kontk='08' then mj:='kolovoza';
  if kontk='09' then mj:='rujna';
  if kontk='10' then mj:='listopada';
  if kontk='11' then mj:='studenog';
  if kontk='12' then mj:='prosinca';
  kontk:=copy(datumrodjenja,1,3);
  if kontk[1]='0' then delete(kontk,1,1);
  datrod:=kontk+' '+mj;
  godrod:=datumrodjenja[9]+datumrodjenja[10];

  nesto:=frmglavna.podaci.Recordset.fields.item['DatRod'].value; datumrodjenja:=nesto;
  kontk:=copy(datumrodjenja,4,2);
  if kontk='01' then mj:='sijeènja';
  if kontk='02' then mj:='veljaèe';
  if kontk='03' then mj:='ožujka';
  if kontk='04' then mj:='travnja';
  if kontk='05' then mj:='svibnja';
  if kontk='06' then mj:='lipnja';
  if kontk='07' then mj:='srpnja';
  if kontk='08' then mj:='kolovoza';
  if kontk='09' then mj:='rujna';
  if kontk='10' then mj:='listopada';
  if kontk='11' then mj:='studenog';
  if kontk='12' then mj:='prosinca';
  kontk:=copy(datumrodjenja,1,3);
  if kontk[1]='0' then delete(kontk,1,1);
  datt:=kontk+' '+mj;
  godd:=datumrodjenja[9]+datumrodjenja[10];


  nesto:=frmglavna.podaci.Recordset.fields.item['Datupisa'].value; dat:=nesto;
  kontk:=copy(dat,4,2);
  if kontk='01' then mj:='sijeènja';
  if kontk='02' then mj:='veljaèe';
  if kontk='03' then mj:='ožujka';
  if kontk='04' then mj:='travnja';
  if kontk='05' then mj:='svibnja';
  if kontk='06' then mj:='lipnja';
  if kontk='07' then mj:='srpnja';
  if kontk='08' then mj:='kolovoza';
  if kontk='09' then mj:='rujna';
  if kontk='10' then mj:='listopada';
  if kontk='11' then mj:='studenog';
  if kontk='12' then mj:='prosinca';
  kontk:=copy(dat,1,3);
  if kontk[1]='0' then delete(kontk,1,1);
  god:=dat[7]+dat[8]+dat[9]+dat[10]+'.';
  datupisa:=kontk+' '+mj+' '+god;

  nesto:=frmglavna.podaci2.Recordset.fields.item['Od'].value; dat:=nesto;
  kontk:=copy(dat,4,2);
  if kontk='01' then mj:='sijeènja';
  if kontk='02' then mj:='veljaèe';
  if kontk='03' then mj:='ožujka';
  if kontk='04' then mj:='travnja';
  if kontk='05' then mj:='svibnja';
  if kontk='06' then mj:='lipnja';
  if kontk='07' then mj:='srpnja';
  if kontk='08' then mj:='kolovoza';
  if kontk='09' then mj:='rujna';
  if kontk='10' then mj:='listopada';
  if kontk='11' then mj:='studenog';
  if kontk='12' then mj:='prosinca';
  kontk:=copy(dat,1,3);
  if kontk[1]='0' then delete(kontk,1,1);
  god:=dat[7]+dat[8]+dat[9]+dat[10]+'.';
  datod:=kontk+' '+mj+' '+god;

  nesto:=frmglavna.podaci2.Recordset.fields.item['Do'].value; dat:=nesto;
  kontk:=copy(dat,4,2);
  if kontk='01' then mj:='sijeènja';
  if kontk='02' then mj:='veljaèe';
  if kontk='03' then mj:='ožujka';
  if kontk='04' then mj:='travnja';
  if kontk='05' then mj:='svibnja';
  if kontk='06' then mj:='lipnja';
  if kontk='07' then mj:='srpnja';
  if kontk='08' then mj:='kolovoza';
  if kontk='09' then mj:='rujna';
  if kontk='10' then mj:='listopada';
  if kontk='11' then mj:='studenog';
  if kontk='12' then mj:='prosinca';
  kontk:=copy(dat,1,3);
  if kontk[1]='0' then delete(kontk,1,1);
  god:=dat[7]+dat[8]+dat[9]+dat[10]+'.';
  datdo:=kontk+' '+mj+' '+god;


  nesto:=frmglavna.podaci.Recordset.fields.item['Datupisa'].value; dat:=nesto;
  km:=dat[7]+dat[8]+dat[9]+dat[10];
  val(km,vkm,c);
  nesto:=frmglavna.podaci.Recordset.fields.item['Razred'].value; dat:=nesto;
  val(dat[1],raz,c);
  kgod1:=(raz-1)+vkm;
  kgod2:=kgod1+1;
  str(kgod1,god1);
  str(kgod2,god2);
  nesto:=frmglavna.podaci.Recordset.fields.item['MjRod'].value; nnesto1:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['DrzRod'].value; nnesto2:=nesto;
  mjestorodjenja:=nnesto1+', '+nnesto2;
  nesto:=frmglavna.podaci.Recordset.fields.item['Drz'].value; drzavljanstvo:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Nar'].value; narodnost:=nesto;
  ocjene[2]:='dovoljan (2)';
  ocjene[3]:='dobar (3)';
  ocjene[4]:='vrlo dobar (4)';
  ocjene[5]:='odlièan (5)';
  nesto:=frmglavna.podaci2.Recordset.fields.item['mat'].value; bmat:=nesto;
  val(bmat,am,c); if am<>0 then mat:=ocjene[am] else mat:='-';
  nesto:=frmglavna.podaci2.Recordset.fields.item['hrv'].value; bmat:=nesto;
  val(bmat,ah,c); if ah<>0 then hrv:=ocjene[ah] else hrv:='-';
  nesto:=frmglavna.podaci2.Recordset.fields.item['izb1'].value; bmat:=nesto;
  val(bmat,a1,c); if a1<>0 then izb1:=ocjene[a1] else izb1:='-';
  nesto:=frmglavna.podaci2.Recordset.fields.item['izb2'].value; bmat:=nesto;
  val(bmat,a2,c); if a2<>0 then izb2:=ocjene[a2] else izb2:='-';
  nesto:=frmglavna.podaci2.Recordset.fields.item['izborni1'].value; bmat:=nesto;
  if bmat<>'' then izborni1:=bmat else izborni1:='-';
  nesto:=frmglavna.podaci2.Recordset.fields.item['izborni2'].value; bmat:=nesto;
  if bmat<>'' then izborni2:=bmat else izborni2:='-';
  nesto:=frmglavna.podaci2.Recordset.fields.item['osl'].value; bmat:=nesto;
  if bmat='DA' then uspjeh:=mat else begin
    pr:=(ah+am+a1+a2)/4;
    if pr>=4.5 then uspjeh:='odlièan (5)';
    if (pr<4.5) and (pr>=3.5) then uspjeh:='vrlo dobar (4)';
    if (pr<3.5) and (pr>=2.5) then uspjeh:='dobar (3)';
    if (pr<2.5) and (pr>=1.5) then uspjeh:='dovoljan (2)';
  end;
  nesto:=frmglavna.podaci.Recordset.fields.item['Imeoca'].value; nnesto1:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Imemajke'].value; nnesto2:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Isprava'].value; isprava:=nesto;
  roditelji:=nnesto1+' i '+nnesto2;
  nesto:=frmglavna.podaci.Recordset.fields.item['MBroj'].value; mbroj:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Vrsta'].value; vrsta:=nesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Klasa'].value; klasa:=nesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['UrBroj'].value; urbroj:=nesto;
  frmglavna.podaci.close;
  frmglavna.podaci2.close;
  with frmglavna.rejv.ProjMan do begin
    stra:=findravecomponent('Report1.Page1',nil) as Travepage;
    komp:=FindRaveComponent('skola',stra) as TRaveText; komp.Text:=skola;
    komp:=FindRaveComponent('adresa',stra) as TRaveText; komp.Text:=aadresa;
    komp:=FindRaveComponent('klasa',stra) as TRaveText; komp.Text:=klasa;
    komp:=FindRaveComponent('urbroj',stra) as TRaveText; komp.Text:=urbroj;
    komp:=FindRaveComponent('mbroj',stra) as TRaveText; komp.Text:=mbroj;
  end;
  with frmglavna.rejv2.ProjMan do begin
    stra:=findravecomponent('Report1.Page1',nil) as Travepage;
    komp:=FindRaveComponent('ime',stra) as TRaveText; komp.Text:=nom;

    komp:=FindRaveComponent('olam1',stra) as TRaveText; komp.Text:=olam1;
    komp:=FindRaveComponent('olaz1',stra) as TRaveText; komp.Text:=olaz1;
    komp:=FindRaveComponent('olam2',stra) as TRaveText; komp.Text:=olam2;
    komp:=FindRaveComponent('olaz2',stra) as TRaveText; komp.Text:=olaz2;
    komp:=FindRaveComponent('olam3',stra) as TRaveText; komp.Text:=olam3;
    komp:=FindRaveComponent('olaz3',stra) as TRaveText; komp.Text:=olaz3;
    komp:=FindRaveComponent('olam4',stra) as TRaveText; komp.Text:=olam4;
    komp:=FindRaveComponent('olaz4',stra) as TRaveText; komp.Text:=olaz4;
    komp:=FindRaveComponent('olam5',stra) as TRaveText; komp.Text:=olam5;
    komp:=FindRaveComponent('olaz5',stra) as TRaveText; komp.Text:=olaz5;
    komp:=FindRaveComponent('ca1',stra) as TRaveText; komp.Text:=ca1;
    komp:=FindRaveComponent('ca2',stra) as TRaveText; komp.Text:=ca2;
    komp:=FindRaveComponent('ca3',stra) as TRaveText; komp.Text:=ca3;
    komp:=FindRaveComponent('k1',stra) as TRaveText; komp.Text:=k1;
    komp:=FindRaveComponent('k2',stra) as TRaveText; komp.Text:=k2;
    komp:=FindRaveComponent('k3',stra) as TRaveText; komp.Text:=k3;
    komp:=FindRaveComponent('kci',stra) as TRaveText; komp.Text:=kci;
    komp:=FindRaveComponent('sin',stra) as TRaveText; komp.Text:=sin;
    komp:=FindRaveComponent('rodjen',stra) as TRaveText; komp.Text:=rodjen;

    komp:=FindRaveComponent('roditelji',stra) as TRaveText; komp.Text:=roditelji;
    komp:=FindRaveComponent('datrod',stra) as TRaveText; komp.Text:=datrod;
    komp:=FindRaveComponent('godrod',stra) as TRaveText; komp.Text:=godrod;
    komp:=FindRaveComponent('mjdrz',stra) as TRaveText; komp.Text:=mjestorodjenja;
    komp:=FindRaveComponent('drz',stra) as TRaveText; komp.Text:=drzavljanstvo;
    komp:=FindRaveComponent('nar',stra) as TRaveText; komp.Text:=narodnost;
    komp:=FindRaveComponent('isprava',stra) as TRaveText; komp.Text:=isprava;
    komp:=FindRaveComponent('datupisa',stra) as TRaveText; komp.Text:=datupisa;
    komp:=FindRaveComponent('vrsta',stra) as TRaveText; komp.Text:=vrsta;
    komp:=FindRaveComponent('datmat',stra) as TRaveText; komp.Text:=datdo;
    komp:=FindRaveComponent('od',stra) as TRaveText; komp.Text:=datod;
    komp:=FindRaveComponent('do',stra) as TRaveText; komp.Text:=datdo;
    komp:=FindRaveComponent('mat',stra) as TRaveText; komp.Text:=mat;
    komp:=FindRaveComponent('hrv',stra) as TRaveText; komp.Text:=hrv;
    komp:=FindRaveComponent('izb1',stra) as TRaveText; komp.Text:=izb1;
    komp:=FindRaveComponent('izb2',stra) as TRaveText; komp.Text:=izb2;
    komp:=FindRaveComponent('izborni1',stra) as TRaveText; komp.Text:=izborni1;
    komp:=FindRaveComponent('izborni2',stra) as TRaveText; komp.Text:=izborni2;
    komp:=FindRaveComponent('uspjeh',stra) as TRaveText; komp.Text:=uspjeh;
    komp:=FindRaveComponent('mjesto',stra) as TRaveText; komp.Text:=mjesto;
    komp:=FindRaveComponent('dat',stra) as TRaveText; komp.Text:=datt;
    komp:=FindRaveComponent('god',stra) as TRaveText; komp.Text:=godd;
  end;
  frmglavna.sistem.DoNativeOutput:=false;
  frmglavna.sistem.DefaultDest:=rdprinter;
  frmglavna.sistem.SystemSetups:=frmglavna.sistem.SystemSetups - [ssAllowSetup];
  frmglavna.rejv.ExecuteReport('Report1');
  frmglavna.rejv.Close;
  application.MessageBox('Molim, okrenite stranu...', 'Registar - ispis maturalne svjedodžbe', mb_OK);
  frmglavna.rejv2.ExecuteReport('Report1');
  frmglavna.rejv2.Close;
end else begin
  if kgj=0 then application.MessageBox('Neki uèenici nemaju podatke o maturi.', 'Registar - ispis maturalne svjedodžbe', mb_OK);
  kgj:=1;
end;
end;
if rbsvjedodzba.Checked=true then begin
  nesto:=frmglavna.podaci.Recordset.fields.item['ID'].value; trazeni:=nesto;
  frmglavna.podaci.close;
  frmglavna.podaci.CommandText:='select * from Postavke';
  frmglavna.podaci.ExecuteOptions;
  frmglavna.podaci.Open;
  nesto:=frmglavna.podaci.Recordset.fields.item['Skola'].value; skola:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Adresa'].value; adresa:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Mjesto'].value; mjesto:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['SkGod'].value; sss:=nesto;
  aadresa:=adresa+', '+mjesto;

  frmglavna.podaci.Close;
  frmglavna.rejv.ProjectFile:='svjedodzba.rav';
  frmglavna.podaci.CommandText:='select * from Ucenici where ID='+trazeni;
  frmglavna.podaci.ExecuteOptions;
  frmglavna.podaci.Open;
  frmglavna.podaci2.Close;
  frmglavna.podaci2.CommandText:='select * from Kraj where ID='+trazeni;
  frmglavna.podaci2.ExecuteOptions;
  frmglavna.podaci2.Open;
  frmglavna.rejv.Open;
  nesto:=frmglavna.podaci.Recordset.fields.item['Ime'].value; nnesto1:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Prezime'].value; nnesto2:=nesto;
  nom:=nnesto1+' '+nnesto2;
  nesto:=frmglavna.podaci.Recordset.fields.item['JMBG'].value; nnesto:=nesto;
  jmbg:=nnesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Spol'].value; nnesto:=nesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Opravdani'].value; nnesto1:=nesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Neopravdani'].value; nnesto2:=nesto;
  val(nnesto1,v1,c); val(nnesto2,v2,c); neopr:=nnesto2;
  str(v1+v2,vx);
  if nnesto='M' then begin
    sin:='--'; kci:=''; rodjen:='';
    upm:='-'; upz:='';
    postm:='-'; postz:='';
    ucdod:='k'; zavz:='o';
    ucca:='k'; ola:='o';
  end else begin
    sin:=''; kci:='--'; rodjen:='a';
    upm:='-'; upz:='-';
    postm:=''; postz:='-';
    ucdod:='ca'; zavz:='la';
    ucca:='ca'; ola:='la';
  end;
  nesto:=frmglavna.podaci.Recordset.fields.item['DatRod'].value; datumrodjenja:=nesto;
  kontk:=copy(datumrodjenja,4,2);
  if kontk='01' then mj:='sijeènja';
  if kontk='02' then mj:='veljaèe';
  if kontk='03' then mj:='ožujka';
  if kontk='04' then mj:='travnja';
  if kontk='05' then mj:='svibnja';
  if kontk='06' then mj:='lipnja';
  if kontk='07' then mj:='srpnja';
  if kontk='08' then mj:='kolovoza';
  if kontk='09' then mj:='rujna';
  if kontk='10' then mj:='listopada';
  if kontk='11' then mj:='studenog';
  if kontk='12' then mj:='prosinca';
  kontk:=copy(datumrodjenja,1,3);
  if kontk[1]='0' then delete(kontk,1,1);
  datrod:=kontk+' '+mj;
  godrod:=datumrodjenja[9]+datumrodjenja[10];

  nesto:=frmglavna.podaci2.Recordset.fields.item['Datum'].value; dat:=nesto;
  kontk:=copy(dat,4,2);
  if kontk='01' then mj:='sijeènja';
  if kontk='02' then mj:='veljaèe';
  if kontk='03' then mj:='ožujka';
  if kontk='04' then mj:='travnja';
  if kontk='05' then mj:='svibnja';
  if kontk='06' then mj:='lipnja';
  if kontk='07' then mj:='srpnja';
  if kontk='08' then mj:='kolovoza';
  if kontk='09' then mj:='rujna';
  if kontk='10' then mj:='listopada';
  if kontk='11' then mj:='studenog';
  if kontk='12' then mj:='prosinca';
  kontk:=copy(dat,1,3);
  if kontk[1]='0' then delete(kontk,1,1);
  datup:=kontk+' '+mj;
  godup:=dat[9]+dat[10];
  nesto:=frmglavna.podaci.Recordset.fields.item['Datupisa'].value; dat:=nesto;
  km:=dat[7]+dat[8]+dat[9]+dat[10];
  val(km,vkm,c);
  nesto:=frmglavna.podaci.Recordset.fields.item['Razred'].value; dat:=nesto;
  val(dat[1],raz,c);
  kgod1:=(raz-1)+vkm;
  kgod2:=kgod1+1;
   god1:=sss[1]+sss[2]+sss[3]+sss[4]+sss[5];
  god2:=sss[7]+sss[8]+sss[9]+sss[10]+sss[11];
  nesto:=frmglavna.podaci.Recordset.fields.item['MjRod'].value; nnesto1:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['DrzRod'].value; nnesto2:=nesto;
  mjestorodjenja:=nnesto1+', '+nnesto2;
  nesto:=frmglavna.podaci.Recordset.fields.item['Drz'].value; drzavljanstvo:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Nar'].value; narodnost:=nesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Datum'].value; datum:=nesto;
  ocjene[1]:='nedovoljan (1)';
  ocjene[2]:='dovoljan (2)';
  ocjene[3]:='dobar (3)';
  ocjene[4]:='vrlo dobar (4)';
  ocjene[5]:='odlièan (5)';
  ned:=false;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Hrv'].value; nnesto:=nesto; if nnesto='' then hrv:='-' else begin val(nnesto,vk,c); hrv:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['lat'].value; nnesto:=nesto; if nnesto='' then lat:='-' else begin val(nnesto,vk,c); lat:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['grc'].value; nnesto:=nesto; if nnesto='' then grc:='-' else begin val(nnesto,vk,c); grc:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['glz'].value; nnesto:=nesto; if nnesto='' then glz:='-' else begin val(nnesto,vk,c); glz:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['lik'].value; nnesto:=nesto; if nnesto='' then lik:='-' else begin val(nnesto,vk,c); lik:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['psi'].value; nnesto:=nesto; if nnesto='' then psi:='-' else begin val(nnesto,vk,c); psi:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['log'].value; nnesto:=nesto; if nnesto='' then log:='-' else begin val(nnesto,vk,c); log:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['fil'].value; nnesto:=nesto; if nnesto='' then fil:='-' else begin val(nnesto,vk,c); fil:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['soc'].value; nnesto:=nesto; if nnesto='' then soc:='-' else begin val(nnesto,vk,c); soc:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['pov'].value; nnesto:=nesto; if nnesto='' then pov:='-' else begin val(nnesto,vk,c); pov:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['zem'].value; nnesto:=nesto; if nnesto='' then zem:='-' else begin val(nnesto,vk,c); zem:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['mat'].value; nnesto:=nesto; if nnesto='' then mat:='-' else begin val(nnesto,vk,c); mat:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['fiz'].value; nnesto:=nesto; if nnesto='' then fiz:='-' else begin val(nnesto,vk,c); fiz:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['kem'].value; nnesto:=nesto; if nnesto='' then kem:='-' else begin val(nnesto,vk,c); kem:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['bio'].value; nnesto:=nesto; if nnesto='' then bio:='-' else begin val(nnesto,vk,c); bio:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['inf'].value; nnesto:=nesto; if nnesto='' then inf:='-' else begin val(nnesto,vk,c); inf:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['pig'].value; nnesto:=nesto; if nnesto='' then pig:='-' else begin val(nnesto,vk,c); pig:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['tzk'].value; nnesto:=nesto; if nnesto='' then tzk:='-' else begin val(nnesto,vk,c); tzk:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['dod1'].value; nnesto:=nesto; if nnesto='' then dod1:='-' else begin val(nnesto,vk,c); dod1:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['dod2'].value; nnesto:=nesto; if nnesto='' then dod2:='-' else begin val(nnesto,vk,c); dod2:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['dod3'].value; nnesto:=nesto; if nnesto='' then dod3:='-' else begin val(nnesto,vk,c); dod3:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['izb1'].value; nnesto:=nesto; if nnesto='' then izb1:='-' else begin val(nnesto,vk,c); izb1:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['izb2'].value; nnesto:=nesto; if nnesto='' then izb2:='-' else begin val(nnesto,vk,c); izb2:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['fak1'].value; nnesto:=nesto; if nnesto='' then fak1:='-' else begin val(nnesto,vk,c); fak1:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['fak2'].value; nnesto:=nesto; if nnesto='' then fak2:='-' else begin val(nnesto,vk,c); fak2:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['PrviJezik'].value; nnesto:=nesto;
  if nnesto<>'' then begin
    jez1:=nnesto;
    nesto:=frmglavna.podaci2.Recordset.fields.item['1jez'].value; nnesto1:=nesto;
    val(nnesto1,vk,c); eng:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true;
  end;
  nesto:=frmglavna.podaci2.Recordset.fields.item['DrugiJezik'].value; nnesto:=nesto;
  if nnesto<>'' then begin
    jez2:=nnesto;
    nesto:=frmglavna.podaci2.Recordset.fields.item['2jez'].value; nnesto1:=nesto;
    val(nnesto1,vk,c); njem:=ocjene[vk]; brojac:=brojac+1; uk:=uk+vk; if vk=1 then ned:=true; 
  end;

  nesto:=frmglavna.podaci2.Recordset.fields.item['Dodatni1'].value; nnesto:=nesto; if nnesto='' then nnesto:='-'; dodatni1:=nnesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Dodatni2'].value; nnesto:=nesto; if nnesto='' then nnesto:='-'; dodatni2:=nnesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Dodatni3'].value; nnesto:=nesto; if nnesto='' then nnesto:='-'; dodatni3:=nnesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Izborni1'].value; nnesto:=nesto; if nnesto='' then nnesto:='-'; izborni1:=nnesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Izborni2'].value; nnesto:=nesto; if nnesto='' then nnesto:='-'; izborni2:=nnesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Fakultativni1'].value; nnesto:=nesto; if nnesto='' then nnesto:='-'; fakultativni1:=nnesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Fakultativni2'].value; nnesto:=nesto; if nnesto='' then nnesto:='-'; fakultativni2:=nnesto;
  pr:=uk/brojac;
  if pr>=4.5 then uspjeh:='odliènim';
  if (pr<4.5) and (pr>=3.5) then uspjeh:='vrlo dobrim';
  if (pr<3.5) and (pr>=2.5) then uspjeh:='dobrim';
  if (pr<2.5) and (pr>=1.5) then uspjeh:='dovoljnim';
  nije:='';
  if ned=true then begin uspjeh:='prolaznim'; nije:='ni'; end;
  nesto:=frmglavna.podaci.Recordset.fields.item['Imeoca'].value; nnesto1:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Imemajke'].value; nnesto2:=nesto;
  roditelji:=nnesto1+' i '+nnesto2;
  nesto:=frmglavna.podaci.Recordset.fields.item['MBroj'].value; mbroj:=nesto;
  nesto:=frmglavna.podaci.Recordset.fields.item['Razred'].value; razred:=nesto;
  if razred[1]='1' then razred:='prvi';
  if razred[1]='2' then razred:='drugi';
  if razred[1]='3' then razred:='treæi';
  if razred[1]='4' then razred:='èetvrti';
  nesto:=frmglavna.podaci.Recordset.fields.item['Vrsta'].value; vrsta:=nesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['kojiput']; kojiput:=nesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['Klasa'].value; klasa:=nesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['vladanje'].value; vladanje:=nesto;
  nesto:=frmglavna.podaci2.Recordset.fields.item['UrBroj'].value; urbroj:=nesto;
  frmglavna.podaci.close;
  frmglavna.podaci2.close;
  with frmglavna.rejv.ProjMan do begin
    stra:=findravecomponent('Izvjesce.Stranica',nil) as Travepage;
    komp:=FindRaveComponent('skola',stra) as TRaveText; komp.Text:=skola;
    komp:=FindRaveComponent('adresa',stra) as TRaveText; komp.Text:=aadresa;
    komp:=FindRaveComponent('klasa',stra) as TRaveText; komp.Text:=klasa;
    komp:=FindRaveComponent('urbroj',stra) as TRaveText; komp.Text:=urbroj;
    komp:=FindRaveComponent('mbroj',stra) as TRaveText; komp.Text:=mbroj;
    komp:=FindRaveComponent('ime',stra) as TRaveText; komp.Text:=nom;

    komp:=FindRaveComponent('sin',stra) as TRaveText; komp.Text:=sin;
    komp:=FindRaveComponent('kci',stra) as TRaveText; komp.Text:=kci;
    komp:=FindRaveComponent('roditelji',stra) as TRaveText; komp.Text:=roditelji;
    komp:=FindRaveComponent('rodjen',stra) as TRaveText; komp.Text:=rodjen;
    komp:=FindRaveComponent('datrod',stra) as TRaveText; komp.Text:=datrod;
    komp:=FindRaveComponent('godrod',stra) as TRaveText; komp.Text:=godrod;
    komp:=FindRaveComponent('mjdrz',stra) as TRaveText; komp.Text:=mjestorodjenja;
    komp:=FindRaveComponent('drz',stra) as TRaveText; komp.Text:=drzavljanstvo;
    komp:=FindRaveComponent('nar',stra) as TRaveText; komp.Text:=narodnost;
    komp:=FindRaveComponent('upm',stra) as TRaveText; komp.Text:=upm;
    komp:=FindRaveComponent('upz',stra) as TRaveText; komp.Text:=upz;
    komp:=FindRaveComponent('jezik1',stra) as TRaveText; komp.Text:=jez1;
    komp:=FindRaveComponent('jezik2',stra) as TRaveText; komp.Text:=jez2;
    komp:=FindRaveComponent('kojiput',stra) as TRaveText; komp.Text:=kojiput;
    komp:=FindRaveComponent('kojiraz',stra) as TRaveText; komp.Text:=razred;
    komp:=FindRaveComponent('vrsta',stra) as TRaveText; komp.Text:=vrsta;
    komp:=FindRaveComponent('postm',stra) as TRaveText; komp.Text:=postm;
    komp:=FindRaveComponent('postz',stra) as TRaveText; komp.Text:=postz;
    komp:=FindRaveComponent('vladanje',stra) as TRaveText; komp.Text:=vladanje;
    komp:=FindRaveComponent('ucdod',stra) as TRaveText; komp.Text:=ucdod;
    komp:=FindRaveComponent('nije',stra) as TRaveText; komp.Text:=nije;
    komp:=FindRaveComponent('uspjeh',stra) as TRaveText; komp.Text:=uspjeh;
    komp:=FindRaveComponent('zavz',stra) as TRaveText; komp.Text:=zavz;
    komp:=FindRaveComponent('razred',stra) as TRaveText; komp.Text:=razred;
    komp:=FindRaveComponent('ucca',stra) as TRaveText; komp.Text:=ucca;
    komp:=FindRaveComponent('ola',stra) as TRaveText; komp.Text:=ola;
    komp:=FindRaveComponent('sati',stra) as TRaveText; komp.Text:=vx;
    komp:=FindRaveComponent('neopr',stra) as TRaveText; komp.Text:=neopr;
    komp:=FindRaveComponent('gdje',stra) as TRaveText; komp.Text:=mjesto;
    komp:=FindRaveComponent('kada',stra) as TRaveText; komp.Text:=datup;
    komp:=FindRaveComponent('kojegod',stra) as TRaveText; komp.Text:=godup;
    komp:=FindRaveComponent('god1',stra) as TRaveText; komp.Text:=god1;
    komp:=FindRaveComponent('god2',stra) as TRaveText; komp.Text:=god2;

    komp:=FindRaveComponent('hrv',stra) as TRaveText; komp.Text:=hrv;
    komp:=FindRaveComponent('jez1',stra) as TRaveText; komp.Text:=eng;
    komp:=FindRaveComponent('jez2',stra) as TRaveText; komp.Text:=njem;
    komp:=FindRaveComponent('lat',stra) as TRaveText; komp.Text:=lat;
    komp:=FindRaveComponent('grc',stra) as TRaveText; komp.Text:=grc;
    komp:=FindRaveComponent('glz',stra) as TRaveText; komp.Text:=glz;
    komp:=FindRaveComponent('lik',stra) as TRaveText; komp.Text:=lik;
    komp:=FindRaveComponent('psi',stra) as TRaveText; komp.Text:=psi;
    komp:=FindRaveComponent('log',stra) as TRaveText; komp.Text:=log;
    komp:=FindRaveComponent('fil',stra) as TRaveText; komp.Text:=fil;
    komp:=FindRaveComponent('soc',stra) as TRaveText; komp.Text:=soc;
    komp:=FindRaveComponent('pov',stra) as TRaveText; komp.Text:=pov;
    komp:=FindRaveComponent('zem',stra) as TRaveText; komp.Text:=zem;
    komp:=FindRaveComponent('mat',stra) as TRaveText; komp.Text:=mat;
    komp:=FindRaveComponent('fiz',stra) as TRaveText; komp.Text:=fiz;
    komp:=FindRaveComponent('kem',stra) as TRaveText; komp.Text:=kem;
    komp:=FindRaveComponent('bio',stra) as TRaveText; komp.Text:=bio;
    komp:=FindRaveComponent('inf',stra) as TRaveText; komp.Text:=inf;
    komp:=FindRaveComponent('pig',stra) as TRaveText; komp.Text:=pig;
    komp:=FindRaveComponent('tzk',stra) as TRaveText; komp.Text:=tzk;
    komp:=FindRaveComponent('dodatni1',stra) as TRaveText; komp.Text:=dodatni1;
    komp:=FindRaveComponent('dodatni2',stra) as TRaveText; komp.Text:=dodatni2;
    komp:=FindRaveComponent('dodatni3',stra) as TRaveText; komp.Text:=dodatni3;
    komp:=FindRaveComponent('dod1',stra) as TRaveText; komp.Text:=dod1;
    komp:=FindRaveComponent('dod2',stra) as TRaveText; komp.Text:=dod2;
    komp:=FindRaveComponent('dod3',stra) as TRaveText; komp.Text:=dod3;
    komp:=FindRaveComponent('izborni1',stra) as TRaveText; komp.Text:=izborni1;
    komp:=FindRaveComponent('izborni2',stra) as TRaveText; komp.Text:=izborni2;
    komp:=FindRaveComponent('izb1',stra) as TRaveText; komp.Text:=izb1;
    komp:=FindRaveComponent('izb2',stra) as TRaveText; komp.Text:=izb2;
    komp:=FindRaveComponent('fakultativni1',stra) as TRaveText; komp.Text:=fakultativni1;
    komp:=FindRaveComponent('fakultativni2',stra) as TRaveText; komp.Text:=fakultativni2;
    komp:=FindRaveComponent('fak1',stra) as TRaveText; komp.Text:=fak1;
    komp:=FindRaveComponent('fak2',stra) as TRaveText; komp.Text:=fak2;
  end;
  frmglavna.sistem.DoNativeOutput:=false;
  frmglavna.sistem.DefaultDest:=rdprinter;
  frmglavna.sistem.SystemSetups:=frmglavna.sistem.SystemSetups - [ssAllowSetup];
  frmglavna.rejv.ExecuteReport('Izvjesce');
  frmglavna.rejv.Close;
end;






end;
end;

procedure TfrmIspis.rbIzvjesceClick(Sender: TObject);
begin
if lbrezultati.ItemIndex>-1 then btPregledaj.Enabled:=true;
if lbrezultati.ItemIndex>-1 then btispisipretraga.Enabled:=true;
ispisovi:=true;
if lbdodano.Items.Count>0 then btispisdodano.Enabled:=true;
if cbrazred2.Text<>'' then btispisrazred.Enabled:=true;
end;

procedure TfrmIspis.rbSvjedodzbaClick(Sender: TObject);
begin
if rbsvjedodzba.Checked=true then btPregledaj.Enabled:=false;
if lbrezultati.ItemIndex>-1 then btispisipretraga.Enabled:=true;

ispisovi:=true;
if lbdodano.Items.Count>0 then btispisdodano.Enabled:=true;
if cbrazred2.Text<>'' then btispisrazred.Enabled:=true;
end;

procedure TfrmIspis.rbMaturaClick(Sender: TObject);
begin
if rbmatura.Checked=true then btPregledaj.Enabled:=false;
if lbrezultati.ItemIndex>-1 then btispisipretraga.Enabled:=true;
ispisovi:=true;
if lbdodano.Items.Count>0 then btispisdodano.Enabled:=true;
if cbrazred2.Text<>'' then btispisrazred.Enabled:=true;
end;

procedure TfrmIspis.lbRezultatiClick(Sender: TObject);
begin
btdodaj.Enabled:=true;
if (rbizvjesce.Checked=true) or (rbsvjedodzba.Checked=true) or (rbmatura.Checked=true) then btispisipretraga.Enabled:=true;
if (rbsvjedodzba.Checked=true) or (rbmatura.Checked=true) then btpregledaj.Enabled:=false;
if rbizvjesce.Checked=true then btpregledaj.Enabled:=true;
end;

procedure TfrmIspis.lbDodanoClick(Sender: TObject);
begin
btizbaci.Enabled:=true;
end;

procedure TfrmIspis.cbRazred2Change(Sender: TObject);
begin
if (ispisovi=true) and (cbrazred2.text<>'') then btispisrazred.Enabled:=true;

end;

end.
